[{"filePath":"E:\\foodiempt-main\\capacitor.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\postcss.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\App.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\AIRecommendations.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\AddressSelector.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\BottomNav.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\CategoryTabs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\FavouriteButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\LocationHeader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\LocationPickerMap.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\MainLayout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\MenuImageUpload.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\NavLink.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\RestaurantReviews.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ReviewForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ScheduleDelivery.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\StatusBadge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\admin\\CouponsManager.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\admin\\PromotionsManager.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\auth\\PhoneLogin.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\layouts\\DashboardLayout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\accordion.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\alert-dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\alert.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\aspect-ratio.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\avatar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\badge.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":33,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":33,"endColumn":30,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\breadcrumb.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\button.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":61,"column":18,"nodeType":"Identifier","messageId":"namedExport","endLine":61,"endColumn":32,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\calendar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\carousel.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\chart.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\checkbox.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\collapsible.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\command.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\context-menu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\drawer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\dropdown-menu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\form.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":130,"column":10,"nodeType":"Identifier","messageId":"namedExport","endLine":130,"endColumn":22,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\hover-card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\input-otp.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\label.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\menubar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\navigation-menu.tsx","messages":[{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from 'react-refresh/only-export-components').","line":110,"column":1,"severity":1,"nodeType":null,"fix":{"range":[4801,4865],"text":" "}},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":112,"column":3,"nodeType":"Identifier","messageId":"namedExport","endLine":112,"endColumn":29}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":1,"source":"import * as React from \"react\";\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\";\nimport { cva } from \"class-variance-authority\";\nimport { ChevronDown } from \"lucide-react\";\n\nimport { cn } from \"@/lib/utils\";\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\"relative z-10 flex max-w-max flex-1 items-center justify-center\", className)}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n));\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName;\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\"group flex flex-1 list-none items-center justify-center space-x-1\", className)}\n    {...props}\n  />\n));\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName;\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item;\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50\",\n);\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n));\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName;\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto\",\n      className,\n    )}\n    {...props}\n  />\n));\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName;\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link;\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className,\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n));\nNavigationMenuViewport.displayName = NavigationMenuPrimitive.Viewport.displayName;\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className,\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n));\nNavigationMenuIndicator.displayName = NavigationMenuPrimitive.Indicator.displayName;\n\n// eslint-disable-next-line react-refresh/only-export-components\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n};\n","usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\pagination.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\popover.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\progress.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\radio-group.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\resizable.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\scroll-area.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\select.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\separator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\sheet.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\sidebar.tsx","messages":[{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from 'react-refresh/only-export-components').","line":612,"column":1,"severity":1,"nodeType":null,"fix":{"range":[22377,22441],"text":" "}},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":637,"column":3,"nodeType":"Identifier","messageId":"namedExport","endLine":637,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":1,"source":"import * as React from \"react\";\nimport { Slot } from \"@radix-ui/react-slot\";\nimport { VariantProps, cva } from \"class-variance-authority\";\nimport { PanelLeft } from \"lucide-react\";\n\nimport { useIsMobile } from \"@/hooks/use-mobile\";\nimport { cn } from \"@/lib/utils\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Sheet, SheetContent } from \"@/components/ui/sheet\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from \"@/components/ui/tooltip\";\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar:state\";\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7;\nconst SIDEBAR_WIDTH = \"16rem\";\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\";\nconst SIDEBAR_WIDTH_ICON = \"3rem\";\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\";\n\ntype SidebarContext = {\n  state: \"expanded\" | \"collapsed\";\n  open: boolean;\n  setOpen: (open: boolean) => void;\n  openMobile: boolean;\n  setOpenMobile: (open: boolean) => void;\n  isMobile: boolean;\n  toggleSidebar: () => void;\n};\n\nconst SidebarContext = React.createContext<SidebarContext | null>(null);\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext);\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\");\n  }\n\n  return context;\n}\n\nconst SidebarProvider = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    defaultOpen?: boolean;\n    open?: boolean;\n    onOpenChange?: (open: boolean) => void;\n  }\n>(({ defaultOpen = true, open: openProp, onOpenChange: setOpenProp, className, style, children, ...props }, ref) => {\n  const isMobile = useIsMobile();\n  const [openMobile, setOpenMobile] = React.useState(false);\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen);\n  const open = openProp ?? _open;\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value;\n      if (setOpenProp) {\n        setOpenProp(openState);\n      } else {\n        _setOpen(openState);\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`;\n    },\n    [setOpenProp, open],\n  );\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open);\n  }, [isMobile, setOpen, setOpenMobile]);\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (event.key === SIDEBAR_KEYBOARD_SHORTCUT && (event.metaKey || event.ctrlKey)) {\n        event.preventDefault();\n        toggleSidebar();\n      }\n    };\n\n    window.addEventListener(\"keydown\", handleKeyDown);\n    return () => window.removeEventListener(\"keydown\", handleKeyDown);\n  }, [toggleSidebar]);\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\";\n\n  const contextValue = React.useMemo<SidebarContext>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar],\n  );\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\"group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar\", className)}\n          ref={ref}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  );\n});\nSidebarProvider.displayName = \"SidebarProvider\";\n\nconst Sidebar = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    side?: \"left\" | \"right\";\n    variant?: \"sidebar\" | \"floating\" | \"inset\";\n    collapsible?: \"offcanvas\" | \"icon\" | \"none\";\n  }\n>(({ side = \"left\", variant = \"sidebar\", collapsible = \"offcanvas\", className, children, ...props }, ref) => {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar();\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        className={cn(\"flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground\", className)}\n        ref={ref}\n        {...props}\n      >\n        {children}\n      </div>\n    );\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    );\n  }\n\n  return (\n    <div\n      ref={ref}\n      className=\"group peer hidden text-sidebar-foreground md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        className={cn(\n          \"relative h-svh w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]\"\n            : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon]\",\n        )}\n      />\n      <div\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className,\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          className=\"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  );\n});\nSidebar.displayName = \"Sidebar\";\n\nconst SidebarTrigger = React.forwardRef<React.ElementRef<typeof Button>, React.ComponentProps<typeof Button>>(\n  ({ className, onClick, ...props }, ref) => {\n    const { toggleSidebar } = useSidebar();\n\n    return (\n      <Button\n        ref={ref}\n        data-sidebar=\"trigger\"\n        variant=\"ghost\"\n        size=\"icon\"\n        className={cn(\"h-7 w-7\", className)}\n        onClick={(event) => {\n          onClick?.(event);\n          toggleSidebar();\n        }}\n        {...props}\n      >\n        <PanelLeft />\n        <span className=\"sr-only\">Toggle Sidebar</span>\n      </Button>\n    );\n  },\n);\nSidebarTrigger.displayName = \"SidebarTrigger\";\n\nconst SidebarRail = React.forwardRef<HTMLButtonElement, React.ComponentProps<\"button\">>(\n  ({ className, ...props }, ref) => {\n    const { toggleSidebar } = useSidebar();\n\n    return (\n      <button\n        ref={ref}\n        data-sidebar=\"rail\"\n        aria-label=\"Toggle Sidebar\"\n        tabIndex={-1}\n        onClick={toggleSidebar}\n        title=\"Toggle Sidebar\"\n        className={cn(\n          \"absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] group-data-[side=left]:-right-4 group-data-[side=right]:left-0 hover:after:bg-sidebar-border sm:flex\",\n          \"[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize\",\n          \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n          \"group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar\",\n          \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n          \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n          className,\n        )}\n        {...props}\n      />\n    );\n  },\n);\nSidebarRail.displayName = \"SidebarRail\";\n\nconst SidebarInset = React.forwardRef<HTMLDivElement, React.ComponentProps<\"main\">>(({ className, ...props }, ref) => {\n  return (\n    <main\n      ref={ref}\n      className={cn(\n        \"relative flex min-h-svh flex-1 flex-col bg-background\",\n        \"peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow\",\n        className,\n      )}\n      {...props}\n    />\n  );\n});\nSidebarInset.displayName = \"SidebarInset\";\n\nconst SidebarInput = React.forwardRef<React.ElementRef<typeof Input>, React.ComponentProps<typeof Input>>(\n  ({ className, ...props }, ref) => {\n    return (\n      <Input\n        ref={ref}\n        data-sidebar=\"input\"\n        className={cn(\n          \"h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring\",\n          className,\n        )}\n        {...props}\n      />\n    );\n  },\n);\nSidebarInput.displayName = \"SidebarInput\";\n\nconst SidebarHeader = React.forwardRef<HTMLDivElement, React.ComponentProps<\"div\">>(({ className, ...props }, ref) => {\n  return <div ref={ref} data-sidebar=\"header\" className={cn(\"flex flex-col gap-2 p-2\", className)} {...props} />;\n});\nSidebarHeader.displayName = \"SidebarHeader\";\n\nconst SidebarFooter = React.forwardRef<HTMLDivElement, React.ComponentProps<\"div\">>(({ className, ...props }, ref) => {\n  return <div ref={ref} data-sidebar=\"footer\" className={cn(\"flex flex-col gap-2 p-2\", className)} {...props} />;\n});\nSidebarFooter.displayName = \"SidebarFooter\";\n\nconst SidebarSeparator = React.forwardRef<React.ElementRef<typeof Separator>, React.ComponentProps<typeof Separator>>(\n  ({ className, ...props }, ref) => {\n    return (\n      <Separator\n        ref={ref}\n        data-sidebar=\"separator\"\n        className={cn(\"mx-2 w-auto bg-sidebar-border\", className)}\n        {...props}\n      />\n    );\n  },\n);\nSidebarSeparator.displayName = \"SidebarSeparator\";\n\nconst SidebarContent = React.forwardRef<HTMLDivElement, React.ComponentProps<\"div\">>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className,\n      )}\n      {...props}\n    />\n  );\n});\nSidebarContent.displayName = \"SidebarContent\";\n\nconst SidebarGroup = React.forwardRef<HTMLDivElement, React.ComponentProps<\"div\">>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  );\n});\nSidebarGroup.displayName = \"SidebarGroup\";\n\nconst SidebarGroupLabel = React.forwardRef<HTMLDivElement, React.ComponentProps<\"div\"> & { asChild?: boolean }>(\n  ({ className, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"div\";\n\n    return (\n      <Comp\n        ref={ref}\n        data-sidebar=\"group-label\"\n        className={cn(\n          \"flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n          \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n          className,\n        )}\n        {...props}\n      />\n    );\n  },\n);\nSidebarGroupLabel.displayName = \"SidebarGroupLabel\";\n\nconst SidebarGroupAction = React.forwardRef<HTMLButtonElement, React.ComponentProps<\"button\"> & { asChild?: boolean }>(\n  ({ className, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\";\n\n    return (\n      <Comp\n        ref={ref}\n        data-sidebar=\"group-action\"\n        className={cn(\n          \"absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n          // Increases the hit area of the button on mobile.\n          \"after:absolute after:-inset-2 after:md:hidden\",\n          \"group-data-[collapsible=icon]:hidden\",\n          className,\n        )}\n        {...props}\n      />\n    );\n  },\n);\nSidebarGroupAction.displayName = \"SidebarGroupAction\";\n\nconst SidebarGroupContent = React.forwardRef<HTMLDivElement, React.ComponentProps<\"div\">>(\n  ({ className, ...props }, ref) => (\n    <div ref={ref} data-sidebar=\"group-content\" className={cn(\"w-full text-sm\", className)} {...props} />\n  ),\n);\nSidebarGroupContent.displayName = \"SidebarGroupContent\";\n\nconst SidebarMenu = React.forwardRef<HTMLUListElement, React.ComponentProps<\"ul\">>(({ className, ...props }, ref) => (\n  <ul ref={ref} data-sidebar=\"menu\" className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)} {...props} />\n));\nSidebarMenu.displayName = \"SidebarMenu\";\n\nconst SidebarMenuItem = React.forwardRef<HTMLLIElement, React.ComponentProps<\"li\">>(({ className, ...props }, ref) => (\n  <li ref={ref} data-sidebar=\"menu-item\" className={cn(\"group/menu-item relative\", className)} {...props} />\n));\nSidebarMenuItem.displayName = \"SidebarMenuItem\";\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:!p-0\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n);\n\nconst SidebarMenuButton = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean;\n    isActive?: boolean;\n    tooltip?: string | React.ComponentProps<typeof TooltipContent>;\n  } & VariantProps<typeof sidebarMenuButtonVariants>\n>(({ asChild = false, isActive = false, variant = \"default\", size = \"default\", tooltip, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\";\n  const { isMobile, state } = useSidebar();\n\n  const button = (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  );\n\n  if (!tooltip) {\n    return button;\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    };\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent side=\"right\" align=\"center\" hidden={state !== \"collapsed\" || isMobile} {...tooltip} />\n    </Tooltip>\n  );\n});\nSidebarMenuButton.displayName = \"SidebarMenuButton\";\n\nconst SidebarMenuAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean;\n    showOnHover?: boolean;\n  }\n>(({ className, asChild = false, showOnHover = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\";\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform peer-hover/menu-button:text-sidebar-accent-foreground hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n        \"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0\",\n        className,\n      )}\n      {...props}\n    />\n  );\n});\nSidebarMenuAction.displayName = \"SidebarMenuAction\";\n\nconst SidebarMenuBadge = React.forwardRef<HTMLDivElement, React.ComponentProps<\"div\">>(\n  ({ className, ...props }, ref) => (\n    <div\n      ref={ref}\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className,\n      )}\n      {...props}\n    />\n  ),\n);\nSidebarMenuBadge.displayName = \"SidebarMenuBadge\";\n\nconst SidebarMenuSkeleton = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    showIcon?: boolean;\n  }\n>(({ className, showIcon = false, ...props }, ref) => {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`;\n  }, []);\n\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && <Skeleton className=\"size-4 rounded-md\" data-sidebar=\"menu-skeleton-icon\" />}\n      <Skeleton\n        className=\"h-4 max-w-[--skeleton-width] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  );\n});\nSidebarMenuSkeleton.displayName = \"SidebarMenuSkeleton\";\n\nconst SidebarMenuSub = React.forwardRef<HTMLUListElement, React.ComponentProps<\"ul\">>(\n  ({ className, ...props }, ref) => (\n    <ul\n      ref={ref}\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className,\n      )}\n      {...props}\n    />\n  ),\n);\nSidebarMenuSub.displayName = \"SidebarMenuSub\";\n\nconst SidebarMenuSubItem = React.forwardRef<HTMLLIElement, React.ComponentProps<\"li\">>(({ ...props }, ref) => (\n  <li ref={ref} {...props} />\n));\nSidebarMenuSubItem.displayName = \"SidebarMenuSubItem\";\n\nconst SidebarMenuSubButton = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentProps<\"a\"> & {\n    asChild?: boolean;\n    size?: \"sm\" | \"md\";\n    isActive?: boolean;\n  }\n>(({ asChild = false, size = \"md\", isActive, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\";\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring aria-disabled:pointer-events-none aria-disabled:opacity-50 hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className,\n      )}\n      {...props}\n    />\n  );\n});\nSidebarMenuSubButton.displayName = \"SidebarMenuSubButton\";\n\n// eslint-disable-next-line react-refresh/only-export-components\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n};\n","usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\skeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\slider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\sonner.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":28,"column":19,"nodeType":"Identifier","messageId":"namedExport","endLine":28,"endColumn":24,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\switch.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\table.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\tabs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\textarea.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\toast.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\toaster.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\toggle-group.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\toggle.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":38,"column":18,"nodeType":"Identifier","messageId":"namedExport","endLine":38,"endColumn":32,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\tooltip.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\components\\ui\\use-toast.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\hooks\\use-mobile.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\hooks\\use-toast.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\hooks\\useAuth.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":99,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":99,"endColumn":24,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\hooks\\useGeolocation.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\hooks\\useHaptics.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\hooks\\useOrderNotifications.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\integrations\\firebase\\client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\integrations\\supabase\\client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\integrations\\supabase\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\main.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\pages\\Auth.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\pages\\Cart.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\pages\\Contact.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\pages\\Index.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\pages\\NotFound.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\pages\\Offers.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\pages\\OrderTracking.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\pages\\Orders.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\pages\\Privacy.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\pages\\Profile.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\pages\\Promotions.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\pages\\Refer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\pages\\Refund.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\pages\\RestaurantDetail.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\pages\\Terms.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\pages\\admin\\AdminDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\pages\\delivery\\DeliveryDashboard.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchData'. Either include it or remove the dependency array.","line":125,"column":6,"nodeType":"ArrayExpression","endLine":125,"endColumn":23,"suggestions":[{"desc":"Update the dependencies array to be: [deliveryPartner, fetchData]","fix":{"range":[4056,4073],"text":"[deliveryPartner, fetchData]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { Order, OrderStatus, DeliveryPartner } from '@/types/database';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Switch } from '@/components/ui/switch';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { StatusBadge } from '@/components/StatusBadge';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n  AlertDialogTrigger,\r\n} from '@/components/ui/alert-dialog';\r\nimport {\r\n  Bike,\r\n  ArrowLeft,\r\n  MapPin,\r\n  Navigation,\r\n  Package,\r\n  Clock,\r\n  CheckCircle,\r\n  Phone,\r\n  Key,\r\n  Banknote,\r\n  Smartphone,\r\n  AlertCircle,\r\n  Shield,\r\n  History,\r\n  Wallet,\r\n  IndianRupee,\r\n  TrendingUp,\r\n  User,\r\n  RefreshCw,\r\n  ExternalLink,\r\n  X,\r\n  BarChart3,\r\n  FileText,\r\n  Headphones,\r\n  Star,\r\n  Calendar,\r\n  Percent,\r\n  Award\r\n} from 'lucide-react';\r\nimport { toast } from 'sonner';\r\nimport { format } from 'date-fns';\r\nimport { useDeliveryPartnerNotifications } from '@/hooks/useOrderNotifications';\r\n\r\ninterface OrderWithDetails extends Order {\r\n  restaurants: { name: string; address: string; phone: string | null } | null;\r\n  customer_profile?: { full_name: string | null; phone: string | null } | null;\r\n}\r\n\r\n// Helper to generate short order ID\r\nconst getShortOrderId = (id: string) => {\r\n  return `#${id.slice(0, 8).toUpperCase()}`;\r\n};\r\n\r\nexport default function DeliveryDashboard() {\r\n  const { user, loading: authLoading } = useAuth();\r\n  const navigate = useNavigate();\r\n  const [deliveryPartner, setDeliveryPartner] = useState<DeliveryPartner | null>(null);\r\n  const [profile, setProfile] = useState<{ full_name: string | null; phone: string | null } | null>(null);\r\n  const [availableOrders, setAvailableOrders] = useState<OrderWithDetails[]>([]);\r\n  const [myOrders, setMyOrders] = useState<OrderWithDetails[]>([]);\r\n  const [orderHistory, setOrderHistory] = useState<OrderWithDetails[]>([]);\r\n  const [earnings, setEarnings] = useState({ today: 0, week: 0, total: 0, pending: 0 });\r\n  const [avgRating, setAvgRating] = useState<number | null>(null);\r\n  const [totalRatings, setTotalRatings] = useState(0);\r\n  const [loading, setLoading] = useState(true);\r\n  const [refreshing, setRefreshing] = useState(false);\r\n  const [showRegister, setShowRegister] = useState(false);\r\n  const [deliveryOtpInputs, setDeliveryOtpInputs] = useState<Record<string, string>>({});\r\n  const [deliveryOtpErrors, setDeliveryOtpErrors] = useState<Record<string, boolean>>({});\r\n  const [pickupOtpInputs, setPickupOtpInputs] = useState<Record<string, string>>({});\r\n  const [pickupOtpErrors, setPickupOtpErrors] = useState<Record<string, boolean>>({});\r\n\r\n  // Phone verification states\r\n  const [phoneNumber, setPhoneNumber] = useState('');\r\n  const [verificationOtp, setVerificationOtp] = useState('');\r\n  const [showVerificationInput, setShowVerificationInput] = useState(false);\r\n  const [generatedOtp, setGeneratedOtp] = useState('');\r\n\r\n  useEffect(() => {\r\n    if (!authLoading) {\r\n      if (!user) {\r\n        navigate('/auth');\r\n        return;\r\n      }\r\n      fetchData();\r\n    }\r\n  }, [user, authLoading, navigate, fetchData]);\r\n\r\n  // Real-time order updates\r\n  useEffect(() => {\r\n    if (!deliveryPartner) return;\r\n\r\n    const channel = supabase\r\n      .channel('delivery-orders')\r\n      .on(\r\n        'postgres_changes',\r\n        {\r\n          event: '*',\r\n          schema: 'public',\r\n          table: 'orders'\r\n        },\r\n        () => {\r\n          fetchData();\r\n        }\r\n      )\r\n      .subscribe();\r\n\r\n    return () => {\r\n      supabase.removeChannel(channel);\r\n    };\r\n  }, [deliveryPartner]);\r\n\r\n  // Sound notifications for available orders\r\n  useDeliveryPartnerNotifications(deliveryPartner?.id, deliveryPartner?.is_available || false);\r\n\r\n  const fetchData = useCallback(async () => {\r\n    try {\r\n      // Check if user is a delivery partner\r\n      const { data: partnerData } = await supabase\r\n        .from('delivery_partners')\r\n        .select('*')\r\n        .eq('user_id', user!.id)\r\n        .maybeSingle();\r\n\r\n      // Fetch user profile\r\n      const { data: profileData } = await supabase\r\n        .from('profiles')\r\n        .select('full_name, phone')\r\n        .eq('id', user!.id)\r\n        .maybeSingle();\r\n\r\n      if (profileData) setProfile(profileData);\r\n\r\n      if (partnerData) {\r\n        setDeliveryPartner(partnerData);\r\n\r\n        // Fetch available orders (ready_for_pickup with no delivery partner)\r\n        // Include pickup_otp for OTP verification\r\n        const { data: availableData } = await supabase\r\n          .from('orders')\r\n          .select('*, restaurants(name, address, phone)')\r\n          .eq('status', 'ready_for_pickup')\r\n          .is('delivery_partner_id', null)\r\n          .order('created_at', { ascending: false });\r\n\r\n        if (availableData) {\r\n          // Fetch customer profiles for available orders\r\n          const customerIds = availableData.map(o => o.customer_id);\r\n          let customerProfiles: { id: string; full_name: string | null; phone: string | null }[] = [];\r\n\r\n          if (customerIds.length > 0) {\r\n            const { data: profilesData } = await supabase\r\n              .from('profiles')\r\n              .select('id, full_name, phone')\r\n              .in('id', customerIds);\r\n            customerProfiles = profilesData || [];\r\n          }\r\n\r\n          const ordersWithProfiles = availableData.map(order => ({\r\n            ...order,\r\n            customer_profile: customerProfiles.find(p => p.id === order.customer_id) || null\r\n          }));\r\n          setAvailableOrders(ordersWithProfiles);\r\n        }\r\n\r\n        // Fetch my orders with customer info\r\n        const { data: myOrdersData } = await supabase\r\n          .from('orders')\r\n          .select('*, restaurants(name, address, phone)')\r\n          .eq('delivery_partner_id', partnerData.id)\r\n          .in('status', ['picked_up', 'on_the_way'])\r\n          .order('created_at', { ascending: false });\r\n\r\n        if (myOrdersData) {\r\n          // Fetch customer profiles for my orders\r\n          const customerIds = myOrdersData.map(o => o.customer_id);\r\n          let customerProfiles: { id: string; full_name: string | null; phone: string | null }[] = [];\r\n\r\n          if (customerIds.length > 0) {\r\n            const { data: profilesData } = await supabase\r\n              .from('profiles')\r\n              .select('id, full_name, phone')\r\n              .in('id', customerIds);\r\n            customerProfiles = profilesData || [];\r\n          }\r\n\r\n          const ordersWithProfiles = myOrdersData.map(order => ({\r\n            ...order,\r\n            customer_profile: customerProfiles.find(p => p.id === order.customer_id) || null\r\n          }));\r\n          setMyOrders(ordersWithProfiles);\r\n        }\r\n\r\n        // Fetch order history (completed/cancelled)\r\n        const { data: historyData } = await supabase\r\n          .from('orders')\r\n          .select('*, restaurants(name, address, phone)')\r\n          .eq('delivery_partner_id', partnerData.id)\r\n          .in('status', ['delivered', 'cancelled'])\r\n          .order('created_at', { ascending: false })\r\n          .limit(50);\r\n\r\n        if (historyData) setOrderHistory(historyData);\r\n\r\n        // Calculate earnings\r\n        const deliveredOrders = historyData?.filter(o => o.status === 'delivered') || [];\r\n        const today = new Date();\r\n        today.setHours(0, 0, 0, 0);\r\n        const weekAgo = new Date(today);\r\n        weekAgo.setDate(weekAgo.getDate() - 7);\r\n\r\n        const deliveryFee = 30; // Fixed delivery fee per order\r\n        const todayEarnings = deliveredOrders\r\n          .filter(o => new Date(o.created_at) >= today)\r\n          .length * deliveryFee;\r\n        const weekEarnings = deliveredOrders\r\n          .filter(o => new Date(o.created_at) >= weekAgo)\r\n          .length * deliveryFee;\r\n        const totalEarnings = deliveredOrders.length * deliveryFee;\r\n        const pendingSettlement = Math.floor(totalEarnings * 0.2); // 20% pending\r\n\r\n        setEarnings({\r\n          today: todayEarnings,\r\n          week: weekEarnings,\r\n          total: totalEarnings,\r\n          pending: pendingSettlement\r\n        });\r\n\r\n        // Fetch ratings for this delivery partner\r\n        const { data: ratingsData } = await supabase\r\n          .from('order_ratings')\r\n          .select('rating')\r\n          .eq('delivery_partner_id', partnerData.id);\r\n\r\n        if (ratingsData && ratingsData.length > 0) {\r\n          const total = ratingsData.reduce((sum, r) => sum + r.rating, 0);\r\n          setAvgRating(total / ratingsData.length);\r\n          setTotalRatings(ratingsData.length);\r\n        } else {\r\n          setAvgRating(null);\r\n          setTotalRatings(0);\r\n        }\r\n      } else {\r\n        setShowRegister(true);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching data:', error);\r\n      toast.error('Failed to load data');\r\n    }\r\n\r\n    setLoading(false);\r\n    setRefreshing(false);\r\n  }, [user]);\r\n\r\n  const handleRefresh = () => {\r\n    setRefreshing(true);\r\n    fetchData();\r\n  };\r\n\r\n  const sendVerificationOtp = () => {\r\n    if (!phoneNumber || phoneNumber.length < 10) {\r\n      toast.error('Please enter a valid phone number');\r\n      return;\r\n    }\r\n\r\n    // Generate OTP (demo mode - show in app)\r\n    const otp = Math.floor(1000 + Math.random() * 9000).toString();\r\n    setGeneratedOtp(otp);\r\n    setShowVerificationInput(true);\r\n    toast.success(`Demo OTP: ${otp} (In production, this would be sent via SMS)`);\r\n  };\r\n\r\n  const verifyPhoneOtp = () => {\r\n    if (verificationOtp === generatedOtp) {\r\n      registerAsPartner();\r\n    } else {\r\n      toast.error('Invalid OTP. Please try again.');\r\n    }\r\n  };\r\n\r\n  const registerAsPartner = async () => {\r\n    const { data, error } = await supabase\r\n      .from('delivery_partners')\r\n      .insert({\r\n        user_id: user!.id,\r\n        is_available: false,\r\n        vehicle_type: 'Bike',\r\n        phone: phoneNumber,\r\n        phone_verified: true,\r\n      })\r\n      .select()\r\n      .single();\r\n\r\n    if (error) {\r\n      toast.error(error.message);\r\n    } else {\r\n      // Use secure RPC to assign delivery_partner role\r\n      await supabase.rpc('request_delivery_partner_role');\r\n\r\n      setDeliveryPartner(data);\r\n      setShowRegister(false);\r\n      toast.success('Registered as delivery partner!');\r\n    }\r\n  };\r\n\r\n  const toggleAvailability = async () => {\r\n    if (!deliveryPartner) return;\r\n\r\n    const { error } = await supabase\r\n      .from('delivery_partners')\r\n      .update({ is_available: !deliveryPartner.is_available })\r\n      .eq('id', deliveryPartner.id);\r\n\r\n    if (error) {\r\n      toast.error('Failed to update availability');\r\n    } else {\r\n      setDeliveryPartner({ ...deliveryPartner, is_available: !deliveryPartner.is_available });\r\n      toast.success(deliveryPartner.is_available ? 'You are now offline' : 'You are now online');\r\n      if (!deliveryPartner.is_available) fetchData(); // Refresh available orders\r\n    }\r\n  };\r\n\r\n  const verifyPickupAndAccept = async (order: OrderWithDetails) => {\r\n    if (!deliveryPartner) return;\r\n\r\n    // Check if partner already has an active order\r\n    const { data: hasActive } = await supabase.rpc('partner_has_active_order');\r\n    if (hasActive) {\r\n      toast.error('Complete your current delivery first. One order at a time.');\r\n      return;\r\n    }\r\n\r\n    const otpValue = pickupOtpInputs[order.id] || '';\r\n\r\n    // Use secure server-side RPC for OTP verification\r\n    const { data, error } = await supabase.rpc('verify_pickup_and_accept_order', {\r\n      _order_id: order.id,\r\n      _pickup_otp: otpValue\r\n    });\r\n\r\n    if (error) {\r\n      toast.error('Failed to accept order');\r\n      return;\r\n    }\r\n\r\n    if (data) {\r\n      toast.success('Order accepted!');\r\n      setPickupOtpInputs(prev => ({ ...prev, [order.id]: '' }));\r\n      setPickupOtpErrors(prev => ({ ...prev, [order.id]: false }));\r\n      fetchData();\r\n    } else {\r\n      setPickupOtpErrors(prev => ({ ...prev, [order.id]: true }));\r\n      toast.error('Invalid pickup OTP. Please check with the restaurant.');\r\n    }\r\n  };\r\n\r\n  const updateOrderStatus = async (orderId: string, status: OrderStatus) => {\r\n    const { error } = await supabase\r\n      .from('orders')\r\n      .update({ status })\r\n      .eq('id', orderId);\r\n\r\n    if (error) {\r\n      toast.error('Failed to update status');\r\n    } else {\r\n      toast.success('Status updated');\r\n      setDeliveryOtpInputs(prev => ({ ...prev, [orderId]: '' }));\r\n      setDeliveryOtpErrors(prev => ({ ...prev, [orderId]: false }));\r\n      fetchData();\r\n    }\r\n  };\r\n\r\n  const verifyAndDeliver = async (order: OrderWithDetails) => {\r\n    const otpValue = deliveryOtpInputs[order.id] || '';\r\n\r\n    // Use secure server-side RPC for OTP verification\r\n    const { data, error } = await supabase.rpc('verify_delivery_and_complete', {\r\n      _order_id: order.id,\r\n      _delivery_otp: otpValue\r\n    });\r\n\r\n    if (error) {\r\n      toast.error('Failed to update status');\r\n      return;\r\n    }\r\n\r\n    if (data) {\r\n      toast.success('Order delivered!');\r\n      setDeliveryOtpInputs(prev => ({ ...prev, [order.id]: '' }));\r\n      setDeliveryOtpErrors(prev => ({ ...prev, [order.id]: false }));\r\n      fetchData();\r\n    } else {\r\n      setDeliveryOtpErrors(prev => ({ ...prev, [order.id]: true }));\r\n      toast.error('Invalid OTP. Please check with the customer.');\r\n    }\r\n  };\r\n\r\n  const releaseOrderToPool = async (orderId: string) => {\r\n    // Use secure RPC to release order back to pool for another partner\r\n    const { data, error } = await supabase.rpc('release_order_to_pool', {\r\n      _order_id: orderId\r\n    });\r\n\r\n    if (error) {\r\n      toast.error('Failed to release order');\r\n    } else if (data) {\r\n      toast.success('Order released for another partner');\r\n      setDeliveryOtpInputs(prev => ({ ...prev, [orderId]: '' }));\r\n      setDeliveryOtpErrors(prev => ({ ...prev, [orderId]: false }));\r\n      setPickupOtpInputs(prev => ({ ...prev, [orderId]: '' }));\r\n      setPickupOtpErrors(prev => ({ ...prev, [orderId]: false }));\r\n      fetchData();\r\n    } else {\r\n      toast.error('Could not release order');\r\n    }\r\n  };\r\n\r\n  if (authLoading || loading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\r\n        <div className=\"animate-pulse text-muted-foreground\">Loading...</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (showRegister) {\r\n    return (\r\n      <div className=\"min-h-screen bg-background\">\r\n        <header className=\"sticky top-0 z-50 bg-card/95 backdrop-blur-md border-b border-border\">\r\n          <div className=\"container mx-auto px-4 py-4\">\r\n            <Link to=\"/\" className=\"flex items-center gap-2 text-foreground hover:text-primary transition-colors\">\r\n              <ArrowLeft className=\"w-5 h-5\" />\r\n              <span>Back</span>\r\n            </Link>\r\n          </div>\r\n        </header>\r\n        <div className=\"container mx-auto px-4 py-8 max-w-md\">\r\n          <Card className=\"border-0 shadow-lg\">\r\n            <CardContent className=\"py-8\">\r\n              <div className=\"text-center mb-6\">\r\n                <div className=\"w-20 h-20 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4\">\r\n                  <Bike className=\"w-10 h-10 text-primary\" />\r\n                </div>\r\n                <h2 className=\"text-2xl font-bold mb-2\">Become a Delivery Partner</h2>\r\n                <p className=\"text-muted-foreground\">\r\n                  Earn money delivering food to customers in your area\r\n                </p>\r\n              </div>\r\n\r\n              {!showVerificationInput ? (\r\n                <div className=\"space-y-4\">\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"phone\">Phone Number</Label>\r\n                    <div className=\"relative\">\r\n                      <Phone className=\"absolute left-3 top-3 h-4 w-4 text-muted-foreground\" />\r\n                      <Input\r\n                        id=\"phone\"\r\n                        type=\"tel\"\r\n                        placeholder=\"+1 234 567 8900\"\r\n                        value={phoneNumber}\r\n                        onChange={(e) => setPhoneNumber(e.target.value)}\r\n                        className=\"pl-10\"\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                  <Button onClick={sendVerificationOtp} className=\"w-full\" size=\"lg\">\r\n                    <Shield className=\"w-4 h-4 mr-2\" />\r\n                    Send Verification OTP\r\n                  </Button>\r\n                </div>\r\n              ) : (\r\n                <div className=\"space-y-4\">\r\n                  <div className=\"p-3 bg-accent/10 rounded-lg border border-accent/20 text-center\">\r\n                    <p className=\"text-sm text-accent font-medium\">Demo OTP: {generatedOtp}</p>\r\n                    <p className=\"text-xs text-muted-foreground mt-1\">In production, this would be sent via SMS</p>\r\n                  </div>\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"otp\">Enter OTP</Label>\r\n                    <Input\r\n                      id=\"otp\"\r\n                      type=\"text\"\r\n                      placeholder=\"Enter 4-digit OTP\"\r\n                      value={verificationOtp}\r\n                      onChange={(e) => setVerificationOtp(e.target.value.replace(/\\D/g, '').slice(0, 4))}\r\n                      className=\"font-mono text-center text-lg tracking-widest\"\r\n                      maxLength={4}\r\n                    />\r\n                  </div>\r\n                  <Button onClick={verifyPhoneOtp} className=\"w-full\" size=\"lg\" disabled={verificationOtp.length !== 4}>\r\n                    <CheckCircle className=\"w-4 h-4 mr-2\" />\r\n                    Verify & Register\r\n                  </Button>\r\n                  <Button variant=\"outline\" onClick={() => setShowVerificationInput(false)} className=\"w-full\">\r\n                    Change Phone Number\r\n                  </Button>\r\n                </div>\r\n              )}\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const currentOrder = myOrders[0];\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background\">\r\n      <header className=\"sticky top-0 z-50 bg-card/95 backdrop-blur-md border-b border-border\">\r\n        <div className=\"container mx-auto px-4 py-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center gap-4\">\r\n              <Link to=\"/\" className=\"text-foreground hover:text-primary transition-colors\">\r\n                <ArrowLeft className=\"w-5 h-5\" />\r\n              </Link>\r\n              <div className=\"flex items-center gap-2\">\r\n                <Bike className=\"w-5 h-5 text-primary hidden md:block\" />\r\n                <div>\r\n                  <h1 className=\"text-lg font-bold leading-tight\">Delivery Dashboard</h1>\r\n                  {profile?.full_name && (\r\n                    <p className=\"text-xs text-muted-foreground flex items-center gap-1\">\r\n                      <User className=\"w-3 h-3\" /> {profile.full_name}\r\n                    </p>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"flex items-center gap-3\">\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"icon\"\r\n                onClick={handleRefresh}\r\n                disabled={refreshing}\r\n                className=\"h-8 w-8\"\r\n              >\r\n                <RefreshCw className={`w-4 h-4 ${refreshing ? 'animate-spin' : ''}`} />\r\n              </Button>\r\n              <div className=\"flex items-center gap-2\">\r\n                <span className={`text-sm ${deliveryPartner?.is_available ? 'text-accent' : 'text-muted-foreground'}`}>\r\n                  {deliveryPartner?.is_available ? 'Online' : 'Offline'}\r\n                </span>\r\n                <Switch\r\n                  checked={deliveryPartner?.is_available || false}\r\n                  onCheckedChange={toggleAvailability}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </header>\r\n\r\n      <div className=\"container mx-auto px-4 py-6\">\r\n        <Tabs defaultValue=\"active\" className=\"space-y-6\">\r\n          <TabsList className=\"grid w-full grid-cols-4\">\r\n            <TabsTrigger value=\"active\" className=\"gap-2\">\r\n              <Package className=\"w-4 h-4\" />\r\n              Active\r\n            </TabsTrigger>\r\n            <TabsTrigger value=\"history\" className=\"gap-2\">\r\n              <History className=\"w-4 h-4\" />\r\n              History\r\n            </TabsTrigger>\r\n            <TabsTrigger value=\"earnings\" className=\"gap-2\">\r\n              <Wallet className=\"w-4 h-4\" />\r\n              Earnings\r\n            </TabsTrigger>\r\n            <TabsTrigger value=\"profile\" className=\"gap-2\">\r\n              <User className=\"w-4 h-4\" />\r\n              Profile\r\n            </TabsTrigger>\r\n          </TabsList>\r\n\r\n          <TabsContent value=\"active\" className=\"space-y-6\">\r\n            {/* Quick Stats */}\r\n            <div className=\"grid grid-cols-3 gap-3\">\r\n              <Card className=\"border-0 shadow-sm\">\r\n                <CardContent className=\"p-3 text-center\">\r\n                  <div className={`w-3 h-3 rounded-full mx-auto mb-1 ${deliveryPartner?.is_available ? 'bg-accent animate-pulse' : 'bg-muted-foreground'}`} />\r\n                  <p className=\"text-xs text-muted-foreground\">Status</p>\r\n                  <p className={`font-semibold text-sm ${deliveryPartner?.is_available ? 'text-accent' : 'text-muted-foreground'}`}>\r\n                    {deliveryPartner?.is_available ? 'Online' : 'Offline'}\r\n                  </p>\r\n                </CardContent>\r\n              </Card>\r\n              <Card className=\"border-0 shadow-sm\">\r\n                <CardContent className=\"p-3 text-center\">\r\n                  <Package className=\"w-4 h-4 mx-auto mb-1 text-primary\" />\r\n                  <p className=\"text-xs text-muted-foreground\">Available</p>\r\n                  <p className=\"font-semibold text-sm\">{availableOrders.length} orders</p>\r\n                </CardContent>\r\n              </Card>\r\n              <Card className=\"border-0 shadow-sm\">\r\n                <CardContent className=\"p-3 text-center\">\r\n                  <CheckCircle className=\"w-4 h-4 mx-auto mb-1 text-status-delivered\" />\r\n                  <p className=\"text-xs text-muted-foreground\">Today</p>\r\n                  <p className=\"font-semibold text-sm\">{earnings.today}</p>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n\r\n            {/* Current Delivery */}\r\n            {currentOrder && (\r\n              <Card className=\"border-0 shadow-lg bg-gradient-to-r from-primary/5 to-accent/5\">\r\n                <CardHeader>\r\n                  <CardTitle className=\"flex items-center justify-between\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <Package className=\"w-5 h-5 text-primary\" />\r\n                      Current Delivery\r\n                    </div>\r\n                    <span className=\"text-sm font-mono bg-secondary px-2 py-1 rounded\">\r\n                      {getShortOrderId(currentOrder.id)}\r\n                    </span>\r\n                  </CardTitle>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"space-y-4\">\r\n                    <div className=\"flex items-start justify-between\">\r\n                      <div>\r\n                        <p className=\"font-semibold text-lg\">{currentOrder.restaurants?.name}</p>\r\n                        <StatusBadge status={currentOrder.status as OrderStatus} />\r\n                      </div>\r\n                      <div className=\"text-right\">\r\n                        <p className=\"font-bold text-primary\">{Number(currentOrder.total_amount).toFixed(2)}</p>\r\n                        <span className=\"flex items-center gap-1 text-xs mt-1\">\r\n                          {currentOrder.payment_method === 'cod' ? (\r\n                            <span className=\"flex items-center gap-1 bg-accent/10 text-accent px-2 py-1 rounded-full\">\r\n                              <Banknote className=\"w-3 h-3\" /> COD\r\n                            </span>\r\n                          ) : (\r\n                            <span className=\"flex items-center gap-1 bg-primary/10 text-primary px-2 py-1 rounded-full\">\r\n                              <Smartphone className=\"w-3 h-3\" /> GPay\r\n                            </span>\r\n                          )}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n\r\n                    {/* Customer Info */}\r\n                    <div className=\"flex items-center justify-between p-3 bg-card rounded-lg border border-primary/20\">\r\n                      <div className=\"flex items-center gap-3\">\r\n                        <div className=\"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center\">\r\n                          <User className=\"w-5 h-5 text-primary\" />\r\n                        </div>\r\n                        <div>\r\n                          <p className=\"font-medium\">{currentOrder.customer_profile?.full_name || 'Customer'}</p>\r\n                          <p className=\"text-sm text-muted-foreground\">Customer</p>\r\n                        </div>\r\n                      </div>\r\n                      {currentOrder.customer_profile?.phone && (\r\n                        <a\r\n                          href={`tel:${currentOrder.customer_profile.phone}`}\r\n                          className=\"flex items-center gap-2 bg-accent text-accent-foreground px-4 py-2 rounded-lg font-medium hover:bg-accent/90 transition-colors\"\r\n                        >\r\n                          <Phone className=\"w-4 h-4\" />\r\n                          Call\r\n                        </a>\r\n                      )}\r\n                    </div>\r\n\r\n                    <div className=\"grid gap-3\">\r\n                      <div className=\"flex items-start gap-3 p-3 bg-card rounded-lg\">\r\n                        <MapPin className=\"w-5 h-5 text-accent mt-0.5\" />\r\n                        <div className=\"flex-1\">\r\n                          <p className=\"text-sm text-muted-foreground\">Pickup from</p>\r\n                          <p className=\"font-medium\">{currentOrder.restaurants?.address}</p>\r\n                          <div className=\"flex items-center gap-3 mt-2\">\r\n                            {currentOrder.restaurants?.phone && (\r\n                              <a href={`tel:${currentOrder.restaurants.phone}`} className=\"flex items-center gap-1 text-primary text-sm hover:underline\">\r\n                                <Phone className=\"w-3 h-3\" />\r\n                                Call Shop\r\n                              </a>\r\n                            )}\r\n                            <a\r\n                              href={`https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(currentOrder.restaurants?.address || '')}`}\r\n                              target=\"_blank\"\r\n                              rel=\"noopener noreferrer\"\r\n                              className=\"flex items-center gap-1 text-accent text-sm hover:underline\"\r\n                            >\r\n                              <ExternalLink className=\"w-3 h-3\" />\r\n                              Navigate\r\n                            </a>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"flex items-start gap-3 p-3 bg-card rounded-lg\">\r\n                        <Navigation className=\"w-5 h-5 text-primary mt-0.5\" />\r\n                        <div className=\"flex-1\">\r\n                          <p className=\"text-sm text-muted-foreground\">Deliver to</p>\r\n                          <p className=\"font-medium\">{currentOrder.delivery_address}</p>\r\n                          <div className=\"flex items-center gap-3 mt-2\">\r\n                            <a\r\n                              href={`https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(currentOrder.delivery_address)}`}\r\n                              target=\"_blank\"\r\n                              rel=\"noopener noreferrer\"\r\n                              className=\"flex items-center gap-1 text-primary text-sm hover:underline\"\r\n                            >\r\n                              <ExternalLink className=\"w-3 h-3\" />\r\n                              Navigate\r\n                            </a>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div className=\"space-y-3\">\r\n                      {currentOrder.status === 'on_the_way' && (\r\n                        <div className=\"space-y-3\">\r\n                          <div className=\"p-3 bg-card rounded-lg border-2 border-primary/20\">\r\n                            <div className=\"flex items-center gap-2 mb-2\">\r\n                              <Key className=\"w-4 h-4 text-primary\" />\r\n                              <span className=\"text-sm font-medium\">Enter Customer OTP</span>\r\n                            </div>\r\n                            <Input\r\n                              type=\"text\"\r\n                              placeholder=\"Enter 4-digit OTP\"\r\n                              value={deliveryOtpInputs[currentOrder.id] || ''}\r\n                              onChange={(e) => {\r\n                                setDeliveryOtpInputs(prev => ({ ...prev, [currentOrder.id]: e.target.value.replace(/\\D/g, '').slice(0, 4) }));\r\n                                setDeliveryOtpErrors(prev => ({ ...prev, [currentOrder.id]: false }));\r\n                              }}\r\n                              className={`font-mono text-center text-lg tracking-widest ${deliveryOtpErrors[currentOrder.id] ? 'border-destructive' : ''}`}\r\n                              maxLength={4}\r\n                            />\r\n                            {deliveryOtpErrors[currentOrder.id] && (\r\n                              <div className=\"flex items-center gap-1 text-destructive text-sm mt-2\">\r\n                                <AlertCircle className=\"w-3 h-3\" />\r\n                                <span>Invalid OTP</span>\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                          <div className=\"flex gap-2\">\r\n                            <Button\r\n                              className=\"flex-1\"\r\n                              variant=\"success\"\r\n                              onClick={() => verifyAndDeliver(currentOrder)}\r\n                              disabled={(deliveryOtpInputs[currentOrder.id] || '').length !== 4}\r\n                            >\r\n                              <CheckCircle className=\"w-4 h-4 mr-2\" />\r\n                              Verify & Deliver\r\n                            </Button>\r\n                            <AlertDialog>\r\n                              <AlertDialogTrigger asChild>\r\n                                <Button variant=\"destructive\" size=\"icon\">\r\n                                  <X className=\"w-4 h-4\" />\r\n                                </Button>\r\n                              </AlertDialogTrigger>\r\n                              <AlertDialogContent>\r\n                                <AlertDialogHeader>\r\n                                  <AlertDialogTitle>Release Order</AlertDialogTitle>\r\n                                  <AlertDialogDescription>\r\n                                    This order will be released back to the pool for another delivery partner to pick up.\r\n                                  </AlertDialogDescription>\r\n                                </AlertDialogHeader>\r\n                                <AlertDialogFooter>\r\n                                  <AlertDialogCancel>No, Keep Order</AlertDialogCancel>\r\n                                  <AlertDialogAction\r\n                                    onClick={() => releaseOrderToPool(currentOrder.id)}\r\n                                    className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\r\n                                  >\r\n                                    Yes, Release\r\n                                  </AlertDialogAction>\r\n                                </AlertDialogFooter>\r\n                              </AlertDialogContent>\r\n                            </AlertDialog>\r\n                          </div>\r\n                        </div>\r\n                      )}\r\n                      {currentOrder.status === 'picked_up' && (\r\n                        <div className=\"flex gap-2\">\r\n                          <Button className=\"flex-1\" onClick={() => updateOrderStatus(currentOrder.id, 'on_the_way')}>\r\n                            <Navigation className=\"w-4 h-4 mr-2\" />\r\n                            Start Delivery\r\n                          </Button>\r\n                          <AlertDialog>\r\n                            <AlertDialogTrigger asChild>\r\n                              <Button variant=\"destructive\" size=\"icon\">\r\n                                <X className=\"w-4 h-4\" />\r\n                              </Button>\r\n                            </AlertDialogTrigger>\r\n                            <AlertDialogContent>\r\n                              <AlertDialogHeader>\r\n                                <AlertDialogTitle>Release Order</AlertDialogTitle>\r\n                                <AlertDialogDescription>\r\n                                  This order will be released back to the pool for another delivery partner to pick up.\r\n                                </AlertDialogDescription>\r\n                              </AlertDialogHeader>\r\n                              <AlertDialogFooter>\r\n                                <AlertDialogCancel>No, Keep Order</AlertDialogCancel>\r\n                                <AlertDialogAction\r\n                                  onClick={() => releaseOrderToPool(currentOrder.id)}\r\n                                  className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\r\n                                >\r\n                                  Yes, Release\r\n                                </AlertDialogAction>\r\n                              </AlertDialogFooter>\r\n                            </AlertDialogContent>\r\n                          </AlertDialog>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            )}\r\n\r\n            {/* Available Orders */}\r\n            {deliveryPartner?.is_available && !currentOrder && (\r\n              <div className=\"space-y-4\">\r\n                <h2 className=\"text-lg font-semibold flex items-center gap-2\">\r\n                  <Package className=\"w-5 h-5\" />\r\n                  Available Orders\r\n                  {availableOrders.length > 0 && (\r\n                    <span className=\"w-6 h-6 bg-primary text-primary-foreground text-sm rounded-full flex items-center justify-center\">\r\n                      {availableOrders.length}\r\n                    </span>\r\n                  )}\r\n                </h2>\r\n\r\n                {availableOrders.length === 0 ? (\r\n                  <Card className=\"border-0 shadow-sm\">\r\n                    <CardContent className=\"py-12 text-center\">\r\n                      <Package className=\"w-12 h-12 text-muted-foreground/30 mx-auto mb-4\" />\r\n                      <p className=\"text-muted-foreground\">No orders available right now</p>\r\n                      <p className=\"text-sm text-muted-foreground mt-1\">New orders will appear here automatically</p>\r\n                    </CardContent>\r\n                  </Card>\r\n                ) : (\r\n                  <div className=\"grid gap-4\">\r\n                    {availableOrders.map((order) => (\r\n                      <Card key={order.id} className=\"border-0 shadow-sm hover:shadow-md transition-shadow\">\r\n                        <CardContent className=\"p-4\">\r\n                          <div className=\"flex items-start justify-between mb-3\">\r\n                            <div>\r\n                              <div className=\"flex items-center gap-2\">\r\n                                <p className=\"font-semibold\">{order.restaurants?.name}</p>\r\n                                <span className=\"text-xs font-mono bg-secondary px-1.5 py-0.5 rounded\">\r\n                                  {getShortOrderId(order.id)}\r\n                                </span>\r\n                              </div>\r\n                              <div className=\"flex items-center gap-2 text-sm text-muted-foreground mt-1\">\r\n                                <Clock className=\"w-4 h-4\" />\r\n                                {format(new Date(order.created_at), 'h:mm a')}\r\n                              </div>\r\n                            </div>\r\n                            <div className=\"text-right\">\r\n                              <p className=\"font-bold text-primary\">{Number(order.total_amount).toFixed(2)}</p>\r\n                              <span className=\"flex items-center gap-1 text-xs mt-1 justify-end\">\r\n                                {order.payment_method === 'cod' ? (\r\n                                  <span className=\"flex items-center gap-1 bg-accent/10 text-accent px-2 py-0.5 rounded-full\">\r\n                                    <Banknote className=\"w-3 h-3\" /> COD\r\n                                  </span>\r\n                                ) : (\r\n                                  <span className=\"flex items-center gap-1 bg-primary/10 text-primary px-2 py-0.5 rounded-full\">\r\n                                    <Smartphone className=\"w-3 h-3\" /> GPay\r\n                                  </span>\r\n                                )}\r\n                              </span>\r\n                            </div>\r\n                          </div>\r\n\r\n                          {/* Customer Info */}\r\n                          <div className=\"flex items-center justify-between p-2 bg-secondary/50 rounded-lg mb-3\">\r\n                            <div className=\"flex items-center gap-2\">\r\n                              <User className=\"w-4 h-4 text-muted-foreground\" />\r\n                              <span className=\"text-sm\">{order.customer_profile?.full_name || 'Customer'}</span>\r\n                            </div>\r\n                            {order.customer_profile?.phone && (\r\n                              <a\r\n                                href={`tel:${order.customer_profile.phone}`}\r\n                                className=\"flex items-center gap-1 text-primary text-xs hover:underline\"\r\n                              >\r\n                                <Phone className=\"w-3 h-3\" />\r\n                                Call\r\n                              </a>\r\n                            )}\r\n                          </div>\r\n\r\n                          <div className=\"space-y-2 text-sm mb-4\">\r\n                            <div className=\"flex items-start gap-2\">\r\n                              <MapPin className=\"w-4 h-4 text-accent mt-0.5\" />\r\n                              <div className=\"flex-1\">\r\n                                <span className=\"text-muted-foreground\">{order.restaurants?.address}</span>\r\n                                <div className=\"flex items-center gap-3 mt-1\">\r\n                                  {order.restaurants?.phone && (\r\n                                    <a href={`tel:${order.restaurants.phone}`} className=\"flex items-center gap-1 text-primary text-xs hover:underline\">\r\n                                      <Phone className=\"w-3 h-3\" />\r\n                                      Call Shop\r\n                                    </a>\r\n                                  )}\r\n                                  <a\r\n                                    href={`https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(order.restaurants?.address || '')}`}\r\n                                    target=\"_blank\"\r\n                                    rel=\"noopener noreferrer\"\r\n                                    className=\"flex items-center gap-1 text-accent text-xs hover:underline\"\r\n                                  >\r\n                                    <ExternalLink className=\"w-3 h-3\" />\r\n                                    Map\r\n                                  </a>\r\n                                </div>\r\n                              </div>\r\n                            </div>\r\n                            <div className=\"flex items-start gap-2\">\r\n                              <Navigation className=\"w-4 h-4 text-primary mt-0.5\" />\r\n                              <span className=\"text-muted-foreground\">{order.delivery_address}</span>\r\n                            </div>\r\n                          </div>\r\n\r\n                          {/* Pickup OTP verification */}\r\n                          <div className=\"space-y-3\">\r\n                            <div className=\"p-3 bg-card rounded-lg border\">\r\n                              <div className=\"flex items-center gap-2 mb-2\">\r\n                                <Key className=\"w-4 h-4 text-accent\" />\r\n                                <span className=\"text-sm font-medium\">Enter Pickup OTP from Shop</span>\r\n                              </div>\r\n                              <Input\r\n                                type=\"text\"\r\n                                placeholder=\"Enter 4-digit OTP\"\r\n                                value={pickupOtpInputs[order.id] || ''}\r\n                                onChange={(e) => {\r\n                                  setPickupOtpInputs(prev => ({ ...prev, [order.id]: e.target.value.replace(/\\D/g, '').slice(0, 4) }));\r\n                                  setPickupOtpErrors(prev => ({ ...prev, [order.id]: false }));\r\n                                }}\r\n                                className={`font-mono text-center text-lg tracking-widest ${pickupOtpErrors[order.id] ? 'border-destructive' : ''}`}\r\n                                maxLength={4}\r\n                              />\r\n                              {pickupOtpErrors[order.id] && (\r\n                                <div className=\"flex items-center gap-1 text-destructive text-sm mt-2\">\r\n                                  <AlertCircle className=\"w-3 h-3\" />\r\n                                  <span>Invalid OTP</span>\r\n                                </div>\r\n                              )}\r\n                            </div>\r\n                            <Button\r\n                              className=\"w-full\"\r\n                              onClick={() => verifyPickupAndAccept(order)}\r\n                              disabled={(pickupOtpInputs[order.id] || '').length !== 4}\r\n                            >\r\n                              Verify & Accept Order\r\n                            </Button>\r\n                          </div>\r\n                        </CardContent>\r\n                      </Card>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            )}\r\n\r\n            {/* Offline State */}\r\n            {!deliveryPartner?.is_available && !currentOrder && (\r\n              <Card className=\"border-0 shadow-sm\">\r\n                <CardContent className=\"py-16 text-center\">\r\n                  <Bike className=\"w-16 h-16 text-muted-foreground/30 mx-auto mb-4\" />\r\n                  <h3 className=\"text-xl font-semibold mb-2\">You're Offline</h3>\r\n                  <p className=\"text-muted-foreground mb-4\">Go online to start receiving delivery requests</p>\r\n                  <Button onClick={toggleAvailability}>Go Online</Button>\r\n                </CardContent>\r\n              </Card>\r\n            )}\r\n          </TabsContent>\r\n\r\n          <TabsContent value=\"history\" className=\"space-y-4\">\r\n            <h2 className=\"text-lg font-semibold flex items-center gap-2\">\r\n              <History className=\"w-5 h-5\" />\r\n              Order History\r\n            </h2>\r\n\r\n            {orderHistory.length === 0 ? (\r\n              <Card className=\"border-0 shadow-sm\">\r\n                <CardContent className=\"py-12 text-center\">\r\n                  <History className=\"w-12 h-12 text-muted-foreground/30 mx-auto mb-4\" />\r\n                  <p className=\"text-muted-foreground\">No completed deliveries yet</p>\r\n                  <p className=\"text-sm text-muted-foreground mt-1\">Your delivery history will appear here</p>\r\n                </CardContent>\r\n              </Card>\r\n            ) : (\r\n              <div className=\"grid gap-4\">\r\n                {orderHistory.map((order) => (\r\n                  <Card key={order.id} className=\"border-0 shadow-sm\">\r\n                    <CardContent className=\"p-4\">\r\n                      <div className=\"flex items-start justify-between mb-2\">\r\n                        <div>\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <p className=\"font-semibold\">{order.restaurants?.name}</p>\r\n                            <span className=\"text-xs font-mono bg-secondary px-1.5 py-0.5 rounded\">\r\n                              {getShortOrderId(order.id)}\r\n                            </span>\r\n                          </div>\r\n                          <div className=\"flex items-center gap-2 text-sm text-muted-foreground mt-1\">\r\n                            <Clock className=\"w-4 h-4\" />\r\n                            {format(new Date(order.created_at), 'MMM d, h:mm a')}\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"text-right\">\r\n                          <StatusBadge status={order.status as OrderStatus} />\r\n                          <p className=\"font-bold text-primary mt-1\">{Number(order.total_amount).toFixed(2)}</p>\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n                        <Navigation className=\"w-4 h-4\" />\r\n                        <span className=\"truncate\">{order.delivery_address}</span>\r\n                      </div>\r\n                      {order.status === 'delivered' && (\r\n                        <div className=\"mt-2 flex items-center gap-1 text-accent text-sm\">\r\n                          <IndianRupee className=\"w-3 h-3\" />\r\n                          <span>Earned: 30</span>\r\n                        </div>\r\n                      )}\r\n                    </CardContent>\r\n                  </Card>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </TabsContent>\r\n\r\n          <TabsContent value=\"earnings\" className=\"space-y-6\">\r\n            {/* Earnings Stats */}\r\n            <div className=\"grid grid-cols-2 gap-4\">\r\n              <Card className=\"border-0 shadow-sm\">\r\n                <CardContent className=\"p-4\">\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <div className=\"w-10 h-10 rounded-lg bg-accent/10 flex items-center justify-center\">\r\n                      <IndianRupee className=\"w-5 h-5 text-accent\" />\r\n                    </div>\r\n                    <div>\r\n                      <p className=\"text-sm text-muted-foreground\">Today</p>\r\n                      <p className=\"text-xl font-bold\">{earnings.today}</p>\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n              <Card className=\"border-0 shadow-sm\">\r\n                <CardContent className=\"p-4\">\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <div className=\"w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center\">\r\n                      <TrendingUp className=\"w-5 h-5 text-primary\" />\r\n                    </div>\r\n                    <div>\r\n                      <p className=\"text-sm text-muted-foreground\">This Week</p>\r\n                      <p className=\"text-xl font-bold\">{earnings.week}</p>\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n              <Card className=\"border-0 shadow-sm\">\r\n                <CardContent className=\"p-4\">\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <div className=\"w-10 h-10 rounded-lg bg-status-delivered/10 flex items-center justify-center\">\r\n                      <Wallet className=\"w-5 h-5 text-status-delivered\" />\r\n                    </div>\r\n                    <div>\r\n                      <p className=\"text-sm text-muted-foreground\">Total Earned</p>\r\n                      <p className=\"text-xl font-bold\">{earnings.total}</p>\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n              <Card className=\"border-0 shadow-sm\">\r\n                <CardContent className=\"p-4\">\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <div className=\"w-10 h-10 rounded-lg bg-status-pending/10 flex items-center justify-center\">\r\n                      <Clock className=\"w-5 h-5 text-status-pending\" />\r\n                    </div>\r\n                    <div>\r\n                      <p className=\"text-sm text-muted-foreground\">Pending</p>\r\n                      <p className=\"text-xl font-bold\">{earnings.pending}</p>\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n\r\n            {/* Settlement Info */}\r\n            <Card className=\"border-0 shadow-md bg-gradient-to-r from-primary/5 to-accent/5\">\r\n              <CardHeader>\r\n                <CardTitle className=\"flex items-center gap-2\">\r\n                  <Wallet className=\"w-5 h-5 text-primary\" />\r\n                  Settlement Info\r\n                </CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"space-y-4\">\r\n                  <div className=\"flex justify-between items-center p-3 bg-card rounded-lg\">\r\n                    <span className=\"text-muted-foreground\">Delivery fee per order</span>\r\n                    <span className=\"font-bold\">30</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between items-center p-3 bg-card rounded-lg\">\r\n                    <span className=\"text-muted-foreground\">Total deliveries</span>\r\n                    <span className=\"font-bold\">{orderHistory.filter(o => o.status === 'delivered').length}</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between items-center p-3 bg-card rounded-lg\">\r\n                    <span className=\"text-muted-foreground\">Settlement cycle</span>\r\n                    <span className=\"font-bold\">Weekly (Every Monday)</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between items-center p-3 bg-card rounded-lg\">\r\n                    <span className=\"text-muted-foreground\">Settlement status</span>\r\n                    <span className=\"font-bold text-accent\">Processed</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between items-center p-3 bg-card rounded-lg\">\r\n                    <span className=\"text-muted-foreground\">Next payout</span>\r\n                    <span className=\"font-bold\">{earnings.pending}</span>\r\n                  </div>\r\n\r\n                  {/* Payment breakdown */}\r\n                  <div className=\"mt-4 p-4 bg-secondary/50 rounded-lg\">\r\n                    <h4 className=\"font-semibold mb-3 flex items-center gap-2\">\r\n                      <FileText className=\"w-4 h-4 text-primary\" />\r\n                      Earnings Breakdown\r\n                    </h4>\r\n                    <div className=\"space-y-2 text-sm\">\r\n                      <div className=\"flex justify-between\">\r\n                        <span className=\"text-muted-foreground\">Gross earnings</span>\r\n                        <span>{earnings.total}</span>\r\n                      </div>\r\n                      <div className=\"flex justify-between\">\r\n                        <span className=\"text-muted-foreground\">Platform fee (0%)</span>\r\n                        <span>0</span>\r\n                      </div>\r\n                      <div className=\"flex justify-between\">\r\n                        <span className=\"text-muted-foreground\">Incentives & bonuses</span>\r\n                        <span className=\"text-accent\">+{Math.floor(orderHistory.filter(o => o.status === 'delivered').length * 5)}</span>\r\n                      </div>\r\n                      <div className=\"border-t border-border my-2\" />\r\n                      <div className=\"flex justify-between font-bold\">\r\n                        <span>Net payout</span>\r\n                        <span className=\"text-primary\">{earnings.total + Math.floor(orderHistory.filter(o => o.status === 'delivered').length * 5)}</span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <p className=\"text-sm text-muted-foreground text-center mt-4\">\r\n                    Settlements are processed every Monday to your registered bank account\r\n                  </p>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </TabsContent>\r\n\r\n          <TabsContent value=\"profile\" className=\"space-y-6\">\r\n            {/* Profile Info */}\r\n            <Card className=\"border-0 shadow-md\">\r\n              <CardHeader>\r\n                <CardTitle className=\"flex items-center gap-2\">\r\n                  <User className=\"w-5 h-5 text-primary\" />\r\n                  Partner Profile\r\n                </CardTitle>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-4\">\r\n                <div className=\"flex justify-between items-center p-3 bg-secondary/50 rounded-lg\">\r\n                  <span className=\"text-muted-foreground\">Name</span>\r\n                  <span className=\"font-medium\">{profile?.full_name || 'Not set'}</span>\r\n                </div>\r\n                <div className=\"flex justify-between items-center p-3 bg-secondary/50 rounded-lg\">\r\n                  <span className=\"text-muted-foreground\">Phone</span>\r\n                  <span className=\"font-medium\">{deliveryPartner?.phone || 'Not set'}</span>\r\n                </div>\r\n                <div className=\"flex justify-between items-center p-3 bg-secondary/50 rounded-lg\">\r\n                  <span className=\"text-muted-foreground\">Vehicle Type</span>\r\n                  <span className=\"font-medium flex items-center gap-2\">\r\n                    <Bike className=\"w-4 h-4\" />\r\n                    {deliveryPartner?.vehicle_type || 'Bike'}\r\n                  </span>\r\n                </div>\r\n                <div className=\"flex justify-between items-center p-3 bg-secondary/50 rounded-lg\">\r\n                  <span className=\"text-muted-foreground\">Phone Verified</span>\r\n                  <span className={`font-medium flex items-center gap-1 ${deliveryPartner?.phone_verified ? 'text-accent' : 'text-destructive'}`}>\r\n                    {deliveryPartner?.phone_verified ? (\r\n                      <>\r\n                        <CheckCircle className=\"w-4 h-4\" />\r\n                        Verified\r\n                      </>\r\n                    ) : (\r\n                      <>\r\n                        <AlertCircle className=\"w-4 h-4\" />\r\n                        Not Verified\r\n                      </>\r\n                    )}\r\n                  </span>\r\n                </div>\r\n                <div className=\"flex justify-between items-center p-3 bg-secondary/50 rounded-lg\">\r\n                  <span className=\"text-muted-foreground\">Status</span>\r\n                  <span className={`font-medium ${deliveryPartner?.is_available ? 'text-accent' : 'text-muted-foreground'}`}>\r\n                    {deliveryPartner?.is_available ? 'Online' : 'Offline'}\r\n                  </span>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Performance Report */}\r\n            <Card className=\"border-0 shadow-md\">\r\n              <CardHeader>\r\n                <CardTitle className=\"flex items-center gap-2\">\r\n                  <BarChart3 className=\"w-5 h-5 text-primary\" />\r\n                  Performance Report\r\n                </CardTitle>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-4\">\r\n                <div className=\"grid grid-cols-2 gap-3\">\r\n                  <div className=\"p-3 bg-secondary/50 rounded-lg text-center\">\r\n                    <div className=\"flex items-center justify-center gap-1 mb-1\">\r\n                      <Package className=\"w-4 h-4 text-primary\" />\r\n                      <span className=\"text-2xl font-bold\">{orderHistory.filter(o => o.status === 'delivered').length}</span>\r\n                    </div>\r\n                    <p className=\"text-xs text-muted-foreground\">Total Deliveries</p>\r\n                  </div>\r\n                  <div className=\"p-3 bg-secondary/50 rounded-lg text-center\">\r\n                    <div className=\"flex items-center justify-center gap-1 mb-1\">\r\n                      <Percent className=\"w-4 h-4 text-accent\" />\r\n                      <span className=\"text-2xl font-bold text-accent\">\r\n                        {orderHistory.length > 0\r\n                          ? Math.round((orderHistory.filter(o => o.status === 'delivered').length / orderHistory.length) * 100)\r\n                          : 0}%\r\n                      </span>\r\n                    </div>\r\n                    <p className=\"text-xs text-muted-foreground\">Success Rate</p>\r\n                  </div>\r\n                  <div className=\"p-3 bg-secondary/50 rounded-lg text-center\">\r\n                    <div className=\"flex items-center justify-center gap-1 mb-1\">\r\n                      <X className=\"w-4 h-4 text-destructive\" />\r\n                      <span className=\"text-2xl font-bold text-destructive\">{orderHistory.filter(o => o.status === 'cancelled').length}</span>\r\n                    </div>\r\n                    <p className=\"text-xs text-muted-foreground\">Cancelled</p>\r\n                  </div>\r\n                  <div className=\"p-3 bg-secondary/50 rounded-lg text-center\">\r\n                    <div className=\"flex items-center justify-center gap-1 mb-1\">\r\n                      <Star className=\"w-4 h-4 text-yellow-500 fill-yellow-500\" />\r\n                      <span className=\"text-2xl font-bold\">\r\n                        {avgRating !== null ? avgRating.toFixed(1) : ''}\r\n                      </span>\r\n                    </div>\r\n                    <p className=\"text-xs text-muted-foreground\">\r\n                      Avg Rating {totalRatings > 0 ? `(${totalRatings})` : ''}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Rating Progress */}\r\n                <div className=\"p-3 bg-gradient-to-r from-primary/10 to-accent/10 rounded-lg\">\r\n                  <div className=\"flex items-center justify-between mb-2\">\r\n                    <span className=\"text-sm font-medium flex items-center gap-1\">\r\n                      <Award className=\"w-4 h-4 text-primary\" />\r\n                      Partner Level\r\n                    </span>\r\n                    <span className=\"text-sm text-primary font-bold\">\r\n                      {orderHistory.filter(o => o.status === 'delivered').length >= 100 ? 'Gold' :\r\n                        orderHistory.filter(o => o.status === 'delivered').length >= 50 ? 'Silver' : 'Bronze'}\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"w-full bg-secondary rounded-full h-2\">\r\n                    <div\r\n                      className=\"bg-gradient-to-r from-primary to-accent h-2 rounded-full transition-all\"\r\n                      style={{ width: `${Math.min(100, (orderHistory.filter(o => o.status === 'delivered').length / 100) * 100)}%` }}\r\n                    />\r\n                  </div>\r\n                  <p className=\"text-xs text-muted-foreground mt-1\">\r\n                    {100 - orderHistory.filter(o => o.status === 'delivered').length} more deliveries to reach Gold\r\n                  </p>\r\n                </div>\r\n\r\n                <div className=\"flex justify-between items-center p-3 bg-secondary/50 rounded-lg\">\r\n                  <span className=\"text-muted-foreground flex items-center gap-2\">\r\n                    <Calendar className=\"w-4 h-4\" />\r\n                    Member Since\r\n                  </span>\r\n                  <span className=\"font-medium\">\r\n                    {deliveryPartner?.created_at\r\n                      ? format(new Date(deliveryPartner.created_at), 'MMM d, yyyy')\r\n                      : 'N/A'}\r\n                  </span>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Help & Support */}\r\n            <Card className=\"border-0 shadow-md\">\r\n              <CardHeader>\r\n                <CardTitle className=\"flex items-center gap-2\">\r\n                  <Headphones className=\"w-5 h-5 text-primary\" />\r\n                  Help & Support\r\n                </CardTitle>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-3\">\r\n                <Link to=\"/contact\" className=\"flex items-center justify-between p-3 bg-secondary/50 rounded-lg hover:bg-secondary transition-colors\">\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <Phone className=\"w-5 h-5 text-primary\" />\r\n                    <div>\r\n                      <p className=\"font-medium\">Contact Support</p>\r\n                      <p className=\"text-xs text-muted-foreground\">Get help with orders & account</p>\r\n                    </div>\r\n                  </div>\r\n                  <ExternalLink className=\"w-4 h-4 text-muted-foreground\" />\r\n                </Link>\r\n                <Link to=\"/terms\" className=\"flex items-center justify-between p-3 bg-secondary/50 rounded-lg hover:bg-secondary transition-colors\">\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <FileText className=\"w-5 h-5 text-primary\" />\r\n                    <div>\r\n                      <p className=\"font-medium\">Partner Guidelines</p>\r\n                      <p className=\"text-xs text-muted-foreground\">Read delivery partner terms</p>\r\n                    </div>\r\n                  </div>\r\n                  <ExternalLink className=\"w-4 h-4 text-muted-foreground\" />\r\n                </Link>\r\n                <a href=\"tel:+911800123456\" className=\"flex items-center justify-between p-3 bg-primary/10 rounded-lg hover:bg-primary/20 transition-colors\">\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <Headphones className=\"w-5 h-5 text-primary\" />\r\n                    <div>\r\n                      <p className=\"font-medium text-primary\">Emergency Helpline</p>\r\n                      <p className=\"text-xs text-muted-foreground\">+91 1800-123-4567</p>\r\n                    </div>\r\n                  </div>\r\n                  <Phone className=\"w-4 h-4 text-primary\" />\r\n                </a>\r\n              </CardContent>\r\n            </Card>\r\n          </TabsContent>\r\n        </Tabs>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\pages\\restaurant\\RestaurantDashboard.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'fetchData' and 'navigate'. Either include them or remove the dependency array.","line":117,"column":6,"nodeType":"ArrayExpression","endLine":117,"endColumn":25,"suggestions":[{"desc":"Update the dependencies array to be: [user, authLoading, fetchData, navigate]","fix":{"range":[3656,3675],"text":"[user, authLoading, fetchData, navigate]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'subscribeToOrders'. Either include it or remove the dependency array.","line":123,"column":6,"nodeType":"ArrayExpression","endLine":123,"endColumn":22,"suggestions":[{"desc":"Update the dependencies array to be: [restaurant?.id, subscribeToOrders]","fix":{"range":[3769,3785],"text":"[restaurant?.id, subscribeToOrders]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport { supabase } from '@/integrations/supabase/client';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { Restaurant, MenuItem, Order, OrderStatus } from '@/types/database';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Switch } from '@/components/ui/switch';\r\nimport { StatusBadge } from '@/components/StatusBadge';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from '@/components/ui/dialog';\r\nimport { MenuImageUpload } from '@/components/MenuImageUpload';\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n  AlertDialogTrigger,\r\n} from \"@/components/ui/alert-dialog\";\r\nimport {\r\n  Store,\r\n  ArrowLeft,\r\n  Plus,\r\n  Package,\r\n  Clock,\r\n  Edit,\r\n  Trash2,\r\n  Key,\r\n  Banknote,\r\n  Smartphone,\r\n  User,\r\n  Phone,\r\n  XCircle,\r\n  History,\r\n  TrendingUp,\r\n  IndianRupee,\r\n  Wallet,\r\n  MapPin,\r\n  Navigation,\r\n  Loader2,\r\n  Settings,\r\n  RefreshCw,\r\n  Search,\r\n  Bike,\r\n  Percent\r\n} from 'lucide-react';\r\nimport { toast } from 'sonner';\r\nimport { format } from 'date-fns';\r\nimport { useRestaurantOrderNotifications } from '@/hooks/useOrderNotifications';\r\n\r\ninterface OrderWithItems extends Order {\r\n  order_items: { quantity: number; unit_price: number; menu_items: { name: string } | null }[];\r\n  customer_profile?: { full_name: string | null; phone: string | null } | null;\r\n}\r\n\r\n// Helper to generate short order ID\r\nconst getShortOrderId = (id: string) => {\r\n  return `#${id.slice(0, 8).toUpperCase()}`;\r\n};\r\n\r\nexport default function RestaurantDashboard() {\r\n  const { user, loading: authLoading } = useAuth();\r\n  const navigate = useNavigate();\r\n  const [restaurant, setRestaurant] = useState<Restaurant | null>(null);\r\n  const [menuItems, setMenuItems] = useState<MenuItem[]>([]);\r\n  const [orders, setOrders] = useState<OrderWithItems[]>([]);\r\n  const [orderHistory, setOrderHistory] = useState<OrderWithItems[]>([]);\r\n  const [earnings, setEarnings] = useState({\r\n    today: 0, week: 0, total: 0, orderCount: 0,\r\n    grossToday: 0, grossWeek: 0, grossTotal: 0,\r\n    deliveryFees: 0, platformFees: 0, commission: 0\r\n  });\r\n  const [loading, setLoading] = useState(true);\r\n  const [refreshing, setRefreshing] = useState(false);\r\n  const [showCreateRestaurant, setShowCreateRestaurant] = useState(false);\r\n  const [showAddItem, setShowAddItem] = useState(false);\r\n  const [editingItem, setEditingItem] = useState<MenuItem | null>(null);\r\n  const [searchOrders, setSearchOrders] = useState('');\r\n  const [searchMenu, setSearchMenu] = useState('');\r\n\r\n  // Form states\r\n  const [restaurantForm, setRestaurantForm] = useState({\r\n    name: '',\r\n    description: '',\r\n    address: '',\r\n    phone: '',\r\n    cuisine_type: '',\r\n    image_url: '',\r\n    lat: '',\r\n    lng: '',\r\n  });\r\n  const [detectingLocation, setDetectingLocation] = useState(false);\r\n\r\n  const [menuItemForm, setMenuItemForm] = useState({\r\n    name: '',\r\n    description: '',\r\n    price: '',\r\n    category: '',\r\n    image_url: '',\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (!authLoading) {\r\n      if (!user) {\r\n        navigate('/auth');\r\n        return;\r\n      }\r\n      fetchData();\r\n    }\r\n  }, [user, authLoading]);\r\n\r\n  useEffect(() => {\r\n    if (restaurant?.id) {\r\n      subscribeToOrders();\r\n    }\r\n  }, [restaurant?.id]);\r\n\r\n  // Sound notifications for new orders\r\n  useRestaurantOrderNotifications(restaurant?.id);\r\n\r\n  const fetchData = async () => {\r\n    // Fetch restaurant owned by user\r\n    const { data: restaurantData } = await supabase\r\n      .from('restaurants')\r\n      .select('*')\r\n      .eq('owner_id', user!.id)\r\n      .maybeSingle();\r\n\r\n    if (restaurantData) {\r\n      setRestaurant(restaurantData);\r\n\r\n      // Fetch menu items\r\n      const { data: menuData } = await supabase\r\n        .from('menu_items')\r\n        .select('*')\r\n        .eq('restaurant_id', restaurantData.id)\r\n        .order('category', { ascending: true });\r\n\r\n      if (menuData) setMenuItems(menuData);\r\n\r\n      // Fetch active orders\r\n      const { data: ordersData } = await supabase\r\n        .from('orders')\r\n        .select('*, order_items(quantity, unit_price, menu_items(name))')\r\n        .eq('restaurant_id', restaurantData.id)\r\n        .in('status', ['pending', 'confirmed', 'preparing', 'ready_for_pickup', 'picked_up', 'on_the_way'])\r\n        .order('created_at', { ascending: false })\r\n        .limit(50);\r\n\r\n      // Fetch order history (delivered/cancelled)\r\n      const { data: historyData } = await supabase\r\n        .from('orders')\r\n        .select('*, order_items(quantity, unit_price, menu_items(name))')\r\n        .eq('restaurant_id', restaurantData.id)\r\n        .in('status', ['delivered', 'cancelled'])\r\n        .order('created_at', { ascending: false })\r\n        .limit(50);\r\n\r\n      const allOrders = [...(ordersData || []), ...(historyData || [])];\r\n      const customerIds = allOrders.map(o => o.customer_id);\r\n      const { data: customerProfiles } = await supabase\r\n        .from('profiles')\r\n        .select('id, full_name, phone')\r\n        .in('id', customerIds);\r\n\r\n      if (ordersData) {\r\n        const ordersWithProfiles = ordersData.map(order => ({\r\n          ...order,\r\n          customer_profile: customerProfiles?.find(p => p.id === order.customer_id) || null\r\n        }));\r\n        setOrders(ordersWithProfiles as OrderWithItems[]);\r\n      }\r\n\r\n      if (historyData) {\r\n        const historyWithProfiles = historyData.map(order => ({\r\n          ...order,\r\n          customer_profile: customerProfiles?.find(p => p.id === order.customer_id) || null\r\n        }));\r\n        setOrderHistory(historyWithProfiles as OrderWithItems[]);\r\n\r\n        // Calculate earnings - EXCLUDE delivery fee and platform fee\r\n        const deliveredOrders = historyData.filter(o => o.status === 'delivered');\r\n        const today = new Date();\r\n        today.setHours(0, 0, 0, 0);\r\n        const weekAgo = new Date(today);\r\n        weekAgo.setDate(weekAgo.getDate() - 7);\r\n\r\n        const platformFee = 8; // Fixed platform fee per order\r\n        const deliveryFee = 25; // Default delivery fee per order\r\n        const commissionRate = restaurantData.commission_rate || 15;\r\n\r\n        // Calculate per-order shop earnings (total - delivery - platform - commission)\r\n        const calculateShopEarnings = (order: OrderWithItems) => {\r\n          const orderDeliveryFee = Number(order.delivery_fee || deliveryFee);\r\n          const subtotal = Number(order.total_amount) - orderDeliveryFee - platformFee;\r\n          const commission = (subtotal * commissionRate) / 100;\r\n          return Math.max(0, subtotal - commission);\r\n        };\r\n\r\n        const todayOrders = deliveredOrders.filter(o => new Date(o.created_at) >= today);\r\n        const weekOrders = deliveredOrders.filter(o => new Date(o.created_at) >= weekAgo);\r\n\r\n        const grossToday = todayOrders.reduce((sum, o) => sum + Number(o.total_amount), 0);\r\n        const grossWeek = weekOrders.reduce((sum, o) => sum + Number(o.total_amount), 0);\r\n        const grossTotal = deliveredOrders.reduce((sum, o) => sum + Number(o.total_amount), 0);\r\n\r\n        const todayShopEarnings = todayOrders.reduce((sum, o) => sum + calculateShopEarnings(o), 0);\r\n        const weekShopEarnings = weekOrders.reduce((sum, o) => sum + calculateShopEarnings(o), 0);\r\n        const totalShopEarnings = deliveredOrders.reduce((sum, o) => sum + calculateShopEarnings(o), 0);\r\n\r\n        const totalDeliveryFees = deliveredOrders.reduce((sum, o) => sum + Number(o.delivery_fee || deliveryFee), 0);\r\n        const totalPlatformFees = deliveredOrders.length * platformFee;\r\n        const totalCommission = deliveredOrders.reduce((sum, o) => {\r\n          const orderDeliveryFee = Number(o.delivery_fee || deliveryFee);\r\n          const subtotal = Number(o.total_amount) - orderDeliveryFee - platformFee;\r\n          return sum + (subtotal * commissionRate) / 100;\r\n        }, 0);\r\n\r\n        setEarnings({\r\n          today: todayShopEarnings,\r\n          week: weekShopEarnings,\r\n          total: totalShopEarnings,\r\n          orderCount: deliveredOrders.length,\r\n          grossToday,\r\n          grossWeek,\r\n          grossTotal,\r\n          deliveryFees: totalDeliveryFees,\r\n          platformFees: totalPlatformFees,\r\n          commission: totalCommission\r\n        });\r\n      }\r\n    } else {\r\n      setShowCreateRestaurant(true);\r\n    }\r\n\r\n    setLoading(false);\r\n    setRefreshing(false);\r\n  };\r\n\r\n  const handleRefresh = () => {\r\n    setRefreshing(true);\r\n    fetchData();\r\n  };\r\n\r\n  // Filtered data\r\n  const filteredOrders = orders.filter(o =>\r\n    o.id.toLowerCase().includes(searchOrders.toLowerCase()) ||\r\n    (o.customer_profile?.full_name?.toLowerCase().includes(searchOrders.toLowerCase()))\r\n  );\r\n\r\n  const filteredMenuItems = menuItems.filter(item =>\r\n    item.name.toLowerCase().includes(searchMenu.toLowerCase()) ||\r\n    (item.category?.toLowerCase().includes(searchMenu.toLowerCase()))\r\n  );\r\n\r\n  const subscribeToOrders = () => {\r\n    const channel = supabase\r\n      .channel('restaurant-orders')\r\n      .on(\r\n        'postgres_changes',\r\n        {\r\n          event: '*',\r\n          schema: 'public',\r\n          table: 'orders',\r\n        },\r\n        () => {\r\n          fetchData();\r\n        }\r\n      )\r\n      .subscribe();\r\n\r\n    return () => {\r\n      supabase.removeChannel(channel);\r\n    };\r\n  };\r\n\r\n  const createRestaurant = async () => {\r\n    if (!restaurantForm.name || !restaurantForm.address) {\r\n      toast.error('Name and address are required');\r\n      return;\r\n    }\r\n\r\n    const { data, error } = await supabase\r\n      .from('restaurants')\r\n      .insert({\r\n        owner_id: user!.id,\r\n        name: restaurantForm.name,\r\n        description: restaurantForm.description || null,\r\n        address: restaurantForm.address,\r\n        phone: restaurantForm.phone || null,\r\n        cuisine_type: restaurantForm.cuisine_type || null,\r\n        image_url: restaurantForm.image_url || null,\r\n        lat: restaurantForm.lat ? parseFloat(restaurantForm.lat) : null,\r\n        lng: restaurantForm.lng ? parseFloat(restaurantForm.lng) : null,\r\n      })\r\n      .select()\r\n      .single();\r\n\r\n    if (error) {\r\n      toast.error(error.message);\r\n    } else {\r\n      // Use secure RPC to assign restaurant_owner role\r\n      await supabase.rpc('request_restaurant_owner_role');\r\n\r\n      setRestaurant(data);\r\n      setShowCreateRestaurant(false);\r\n      toast.success('Shop created! Awaiting admin verification.');\r\n    }\r\n  };\r\n\r\n  const detectCurrentLocation = () => {\r\n    if (!navigator.geolocation) {\r\n      toast.error('Geolocation is not supported by your browser');\r\n      return;\r\n    }\r\n\r\n    setDetectingLocation(true);\r\n    navigator.geolocation.getCurrentPosition(\r\n      (position) => {\r\n        setRestaurantForm(prev => ({\r\n          ...prev,\r\n          lat: position.coords.latitude.toString(),\r\n          lng: position.coords.longitude.toString(),\r\n        }));\r\n        setDetectingLocation(false);\r\n        toast.success('Location detected!');\r\n      },\r\n      (error) => {\r\n        setDetectingLocation(false);\r\n        toast.error('Failed to get location: ' + error.message);\r\n      },\r\n      { enableHighAccuracy: true, timeout: 15000 }\r\n    );\r\n  };\r\n\r\n  const updateShopLocation = async () => {\r\n    if (!restaurant) return;\r\n\r\n    const { error } = await supabase\r\n      .from('restaurants')\r\n      .update({\r\n        lat: restaurantForm.lat ? parseFloat(restaurantForm.lat) : null,\r\n        lng: restaurantForm.lng ? parseFloat(restaurantForm.lng) : null,\r\n      })\r\n      .eq('id', restaurant.id);\r\n\r\n    if (error) {\r\n      toast.error('Failed to update location');\r\n    } else {\r\n      setRestaurant(prev => prev ? {\r\n        ...prev,\r\n        lat: restaurantForm.lat ? parseFloat(restaurantForm.lat) : null,\r\n        lng: restaurantForm.lng ? parseFloat(restaurantForm.lng) : null,\r\n      } : null);\r\n      toast.success('Shop location updated!');\r\n    }\r\n  };\r\n\r\n  const toggleShopStatus = async () => {\r\n    if (!restaurant) return;\r\n\r\n    const { error } = await supabase\r\n      .from('restaurants')\r\n      .update({ is_open: !restaurant.is_open })\r\n      .eq('id', restaurant.id);\r\n\r\n    if (error) {\r\n      toast.error('Failed to update status');\r\n    } else {\r\n      setRestaurant({ ...restaurant, is_open: !restaurant.is_open });\r\n      toast.success(restaurant.is_open ? 'Shop closed' : 'Shop opened');\r\n    }\r\n  };\r\n\r\n  const addMenuItem = async () => {\r\n    if (!menuItemForm.name || !menuItemForm.price) {\r\n      toast.error('Name and price are required');\r\n      return;\r\n    }\r\n\r\n    const { error } = await supabase.from('menu_items').insert({\r\n      restaurant_id: restaurant!.id,\r\n      name: menuItemForm.name,\r\n      description: menuItemForm.description || null,\r\n      price: parseFloat(menuItemForm.price),\r\n      category: menuItemForm.category || null,\r\n      image_url: menuItemForm.image_url || null,\r\n    });\r\n\r\n    if (error) {\r\n      toast.error(error.message);\r\n    } else {\r\n      setMenuItemForm({ name: '', description: '', price: '', category: '', image_url: '' });\r\n      setShowAddItem(false);\r\n      fetchData();\r\n      toast.success('Menu item added');\r\n    }\r\n  };\r\n\r\n  const updateMenuItem = async () => {\r\n    if (!editingItem) return;\r\n\r\n    const { error } = await supabase\r\n      .from('menu_items')\r\n      .update({\r\n        name: menuItemForm.name,\r\n        description: menuItemForm.description || null,\r\n        price: parseFloat(menuItemForm.price),\r\n        category: menuItemForm.category || null,\r\n        image_url: menuItemForm.image_url || null,\r\n      })\r\n      .eq('id', editingItem.id);\r\n\r\n    if (error) {\r\n      toast.error(error.message);\r\n    } else {\r\n      setEditingItem(null);\r\n      setMenuItemForm({ name: '', description: '', price: '', category: '', image_url: '' });\r\n      fetchData();\r\n      toast.success('Menu item updated');\r\n    }\r\n  };\r\n\r\n  const deleteMenuItem = async (id: string) => {\r\n    const { error } = await supabase.from('menu_items').delete().eq('id', id);\r\n    if (error) {\r\n      toast.error(error.message);\r\n    } else {\r\n      fetchData();\r\n      toast.success('Menu item deleted');\r\n    }\r\n  };\r\n\r\n  const toggleItemAvailability = async (item: MenuItem) => {\r\n    const { error } = await supabase\r\n      .from('menu_items')\r\n      .update({ is_available: !item.is_available })\r\n      .eq('id', item.id);\r\n\r\n    if (!error) {\r\n      fetchData();\r\n    }\r\n  };\r\n\r\n  const updateOrderStatus = async (orderId: string, status: OrderStatus) => {\r\n    const { error } = await supabase\r\n      .from('orders')\r\n      .update({ status })\r\n      .eq('id', orderId);\r\n\r\n    if (error) {\r\n      toast.error('Failed to update order');\r\n    } else {\r\n      fetchData();\r\n      toast.success('Order status updated');\r\n    }\r\n  };\r\n\r\n  const cancelOrder = async (orderId: string) => {\r\n    const { error } = await supabase\r\n      .from('orders')\r\n      .update({ status: 'cancelled' })\r\n      .eq('id', orderId);\r\n\r\n    if (error) {\r\n      toast.error('Failed to cancel order');\r\n    } else {\r\n      fetchData();\r\n      toast.success('Order cancelled');\r\n    }\r\n  };\r\n\r\n  if (authLoading || loading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\r\n        <div className=\"animate-pulse text-muted-foreground\">Loading...</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Show create restaurant form\r\n  if (showCreateRestaurant) {\r\n    return (\r\n      <div className=\"min-h-screen bg-background\">\r\n        <header className=\"sticky top-0 z-50 bg-card/95 backdrop-blur-md border-b border-border\">\r\n          <div className=\"container mx-auto px-4 py-4\">\r\n            <Link to=\"/\" className=\"flex items-center gap-2 text-foreground hover:text-primary transition-colors\">\r\n              <ArrowLeft className=\"w-5 h-5\" />\r\n              <span>Back</span>\r\n            </Link>\r\n          </div>\r\n        </header>\r\n        <div className=\"container mx-auto px-4 py-8 max-w-xl\">\r\n          <Card className=\"border-0 shadow-lg\">\r\n            <CardHeader>\r\n              <CardTitle className=\"flex items-center gap-2\">\r\n                <Store className=\"w-5 h-5\" />\r\n                Register Your Shop\r\n              </CardTitle>\r\n            </CardHeader>\r\n            <CardContent className=\"space-y-4\">\r\n              <div className=\"space-y-2\">\r\n                <Label>Shop Name *</Label>\r\n                <Input\r\n                  value={restaurantForm.name}\r\n                  onChange={(e) => setRestaurantForm({ ...restaurantForm, name: e.target.value })}\r\n                  placeholder=\"My Shop\"\r\n                />\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <Label>Description</Label>\r\n                <Textarea\r\n                  value={restaurantForm.description}\r\n                  onChange={(e) => setRestaurantForm({ ...restaurantForm, description: e.target.value })}\r\n                  placeholder=\"Tell customers about your shop...\"\r\n                />\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <Label>Address *</Label>\r\n                <Input\r\n                  value={restaurantForm.address}\r\n                  onChange={(e) => setRestaurantForm({ ...restaurantForm, address: e.target.value })}\r\n                  placeholder=\"123 Main St, City\"\r\n                />\r\n              </div>\r\n              <div className=\"grid grid-cols-2 gap-4\">\r\n                <div className=\"space-y-2\">\r\n                  <Label>Phone</Label>\r\n                  <Input\r\n                    value={restaurantForm.phone}\r\n                    onChange={(e) => setRestaurantForm({ ...restaurantForm, phone: e.target.value })}\r\n                    placeholder=\"+91 1234567890\"\r\n                  />\r\n                </div>\r\n                <div className=\"space-y-2\">\r\n                  <Label>Category</Label>\r\n                  <Input\r\n                    value={restaurantForm.cuisine_type}\r\n                    onChange={(e) => setRestaurantForm({ ...restaurantForm, cuisine_type: e.target.value })}\r\n                    placeholder=\"Food, Grocery...\"\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <Label>Image URL</Label>\r\n                <Input\r\n                  value={restaurantForm.image_url}\r\n                  onChange={(e) => setRestaurantForm({ ...restaurantForm, image_url: e.target.value })}\r\n                  placeholder=\"https://...\"\r\n                />\r\n              </div>\r\n\r\n              {/* Location Section */}\r\n              <div className=\"space-y-3 p-3 bg-secondary/50 rounded-lg\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <Label className=\"flex items-center gap-2\">\r\n                    <MapPin className=\"w-4 h-4 text-primary\" />\r\n                    Shop Location\r\n                  </Label>\r\n                  <Button\r\n                    type=\"button\"\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    onClick={detectCurrentLocation}\r\n                    disabled={detectingLocation}\r\n                    className=\"gap-1\"\r\n                  >\r\n                    {detectingLocation ? (\r\n                      <Loader2 className=\"w-3 h-3 animate-spin\" />\r\n                    ) : (\r\n                      <Navigation className=\"w-3 h-3\" />\r\n                    )}\r\n                    Detect\r\n                  </Button>\r\n                </div>\r\n                <div className=\"grid grid-cols-2 gap-3\">\r\n                  <div className=\"space-y-1\">\r\n                    <Label className=\"text-xs text-muted-foreground\">Latitude</Label>\r\n                    <Input\r\n                      type=\"number\"\r\n                      step=\"any\"\r\n                      value={restaurantForm.lat}\r\n                      onChange={(e) => setRestaurantForm({ ...restaurantForm, lat: e.target.value })}\r\n                      placeholder=\"12.9716\"\r\n                    />\r\n                  </div>\r\n                  <div className=\"space-y-1\">\r\n                    <Label className=\"text-xs text-muted-foreground\">Longitude</Label>\r\n                    <Input\r\n                      type=\"number\"\r\n                      step=\"any\"\r\n                      value={restaurantForm.lng}\r\n                      onChange={(e) => setRestaurantForm({ ...restaurantForm, lng: e.target.value })}\r\n                      placeholder=\"77.5946\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n                {restaurantForm.lat && restaurantForm.lng && (\r\n                  <p className=\"text-xs text-accent flex items-center gap-1\">\r\n                    <MapPin className=\"w-3 h-3\" />\r\n                    Location set successfully\r\n                  </p>\r\n                )}\r\n                <p className=\"text-xs text-muted-foreground\">\r\n                  Location helps customers find your shop and calculate delivery distance\r\n                </p>\r\n              </div>\r\n\r\n              <Button className=\"w-full\" onClick={createRestaurant}>\r\n                Register Shop\r\n              </Button>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const pendingOrders = orders.filter((o) => ['pending', 'confirmed', 'preparing', 'ready_for_pickup'].includes(o.status));\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-background\">\r\n      <header className=\"sticky top-0 z-50 bg-card/95 backdrop-blur-md border-b border-border\">\r\n        <div className=\"container mx-auto px-4 py-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center gap-4\">\r\n              <Link to=\"/\" className=\"text-foreground hover:text-primary transition-colors\">\r\n                <ArrowLeft className=\"w-5 h-5\" />\r\n              </Link>\r\n              <div className=\"flex items-center gap-2\">\r\n                <Store className=\"w-5 h-5 text-primary hidden md:block\" />\r\n                <h1 className=\"text-xl font-bold\">{restaurant?.name}</h1>\r\n              </div>\r\n            </div>\r\n            <div className=\"flex items-center gap-3\">\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"icon\"\r\n                onClick={handleRefresh}\r\n                disabled={refreshing}\r\n                className=\"h-9 w-9\"\r\n              >\r\n                <RefreshCw className={`w-4 h-4 ${refreshing ? 'animate-spin' : ''}`} />\r\n              </Button>\r\n              {!restaurant?.is_verified && (\r\n                <span className=\"text-sm text-status-pending\">Pending Verification</span>\r\n              )}\r\n              <div className=\"flex items-center gap-2\">\r\n                <span className={`text-sm ${restaurant?.is_open ? 'text-accent' : 'text-muted-foreground'}`}>\r\n                  {restaurant?.is_open ? 'Open' : 'Closed'}\r\n                </span>\r\n                <Switch\r\n                  checked={restaurant?.is_open || false}\r\n                  onCheckedChange={toggleShopStatus}\r\n                  disabled={!restaurant?.is_verified}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </header>\r\n\r\n      <div className=\"container mx-auto px-4 py-6\">\r\n        <Tabs defaultValue=\"orders\" className=\"space-y-6\">\r\n          <TabsList className=\"grid w-full grid-cols-5\">\r\n            <TabsTrigger value=\"orders\" className=\"relative gap-2\">\r\n              <Package className=\"w-4 h-4\" />\r\n              <span className=\"hidden sm:inline\">Orders</span>\r\n              {pendingOrders.length > 0 && (\r\n                <span className=\"w-5 h-5 bg-primary text-primary-foreground text-xs rounded-full flex items-center justify-center\">\r\n                  {pendingOrders.length}\r\n                </span>\r\n              )}\r\n            </TabsTrigger>\r\n            <TabsTrigger value=\"menu\" className=\"gap-2\">\r\n              <Edit className=\"w-4 h-4\" />\r\n              <span className=\"hidden sm:inline\">Menu</span>\r\n            </TabsTrigger>\r\n            <TabsTrigger value=\"history\" className=\"gap-2\">\r\n              <History className=\"w-4 h-4\" />\r\n              <span className=\"hidden sm:inline\">History</span>\r\n            </TabsTrigger>\r\n            <TabsTrigger value=\"earnings\" className=\"gap-2\">\r\n              <Wallet className=\"w-4 h-4\" />\r\n              <span className=\"hidden sm:inline\">Earnings</span>\r\n            </TabsTrigger>\r\n            <TabsTrigger value=\"settings\" className=\"gap-2\">\r\n              <Settings className=\"w-4 h-4\" />\r\n              <span className=\"hidden sm:inline\">Settings</span>\r\n            </TabsTrigger>\r\n          </TabsList>\r\n\r\n          {/* Orders Tab */}\r\n          <TabsContent value=\"orders\" className=\"space-y-4\">\r\n            {/* Search */}\r\n            <div className=\"relative\">\r\n              <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground\" />\r\n              <Input\r\n                placeholder=\"Search by order ID or customer...\"\r\n                value={searchOrders}\r\n                onChange={(e) => setSearchOrders(e.target.value)}\r\n                className=\"pl-9\"\r\n              />\r\n            </div>\r\n\r\n            {filteredOrders.length === 0 ? (\r\n              <Card className=\"border-0 shadow-sm\">\r\n                <CardContent className=\"py-16 text-center\">\r\n                  <Package className=\"w-16 h-16 text-muted-foreground/30 mx-auto mb-4\" />\r\n                  <h3 className=\"text-xl font-semibold mb-2\">\r\n                    {searchOrders ? 'No orders found' : 'No active orders'}\r\n                  </h3>\r\n                  <p className=\"text-muted-foreground\">\r\n                    {searchOrders ? 'Try a different search term' : 'Orders will appear here when customers place them'}\r\n                  </p>\r\n                </CardContent>\r\n              </Card>\r\n            ) : (\r\n              <div className=\"grid gap-4\">\r\n                {filteredOrders.map((order) => (\r\n                  <Card key={order.id} className=\"border-0 shadow-sm\">\r\n                    <CardContent className=\"p-4\">\r\n                      <div className=\"flex items-start justify-between mb-3\">\r\n                        <div>\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <span className=\"font-mono text-sm bg-secondary px-1.5 py-0.5 rounded\">\r\n                              {getShortOrderId(order.id)}\r\n                            </span>\r\n                            <StatusBadge status={order.status as OrderStatus} />\r\n                          </div>\r\n                          <div className=\"flex items-center gap-2 text-sm text-muted-foreground mt-1\">\r\n                            <Clock className=\"w-4 h-4\" />\r\n                            {format(new Date(order.created_at), 'MMM d, h:mm a')}\r\n                          </div>\r\n                        </div>\r\n                        <p className=\"font-bold text-primary text-lg\">{Number(order.total_amount).toFixed(2)}</p>\r\n                      </div>\r\n\r\n                      {/* Customer Info */}\r\n                      <div className=\"flex items-center justify-between p-2 bg-secondary/50 rounded-lg mb-3\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <User className=\"w-4 h-4 text-muted-foreground\" />\r\n                          <span className=\"text-sm font-medium\">{order.customer_profile?.full_name || 'Customer'}</span>\r\n                        </div>\r\n                        {order.customer_profile?.phone && (\r\n                          <a\r\n                            href={`tel:${order.customer_profile.phone}`}\r\n                            className=\"flex items-center gap-1 bg-primary text-primary-foreground px-3 py-1 rounded-lg text-sm font-medium hover:bg-primary/90 transition-colors\"\r\n                          >\r\n                            <Phone className=\"w-3 h-3\" />\r\n                            Call\r\n                          </a>\r\n                        )}\r\n                      </div>\r\n\r\n                      {/* Delivery Address */}\r\n                      {order.delivery_address && (\r\n                        <p className=\"text-sm text-muted-foreground mb-3 truncate\">\r\n                           {order.delivery_address}\r\n                        </p>\r\n                      )}\r\n\r\n                      <div className=\"space-y-1 mb-3\">\r\n                        {order.order_items.map((item, idx) => (\r\n                          <p key={idx} className=\"text-sm\">\r\n                            {item.quantity}x {item.menu_items?.name || 'Unknown'} - {(Number(item.unit_price) * item.quantity).toFixed(2)}\r\n                          </p>\r\n                        ))}\r\n                      </div>\r\n\r\n                      <div className=\"flex items-center justify-between pt-3 border-t border-border\">\r\n                        <div className=\"flex gap-2 flex-wrap\">\r\n                          {order.status === 'pending' && (\r\n                            <>\r\n                              <Button size=\"sm\" onClick={() => updateOrderStatus(order.id, 'confirmed')}>\r\n                                Accept\r\n                              </Button>\r\n                              <Button size=\"sm\" variant=\"outline\" onClick={() => updateOrderStatus(order.id, 'cancelled')}>\r\n                                Reject\r\n                              </Button>\r\n                            </>\r\n                          )}\r\n                          {order.status === 'confirmed' && (\r\n                            <>\r\n                              <Button size=\"sm\" onClick={() => updateOrderStatus(order.id, 'preparing')}>\r\n                                Start Preparing\r\n                              </Button>\r\n                              <AlertDialog>\r\n                                <AlertDialogTrigger asChild>\r\n                                  <Button size=\"sm\" variant=\"outline\" className=\"text-destructive\">\r\n                                    <XCircle className=\"w-3 h-3 mr-1\" />\r\n                                    Cancel\r\n                                  </Button>\r\n                                </AlertDialogTrigger>\r\n                                <AlertDialogContent>\r\n                                  <AlertDialogHeader>\r\n                                    <AlertDialogTitle>Cancel Order?</AlertDialogTitle>\r\n                                    <AlertDialogDescription>\r\n                                      Are you sure you want to cancel this order? The customer will be notified.\r\n                                    </AlertDialogDescription>\r\n                                  </AlertDialogHeader>\r\n                                  <AlertDialogFooter>\r\n                                    <AlertDialogCancel>Keep Order</AlertDialogCancel>\r\n                                    <AlertDialogAction\r\n                                      onClick={() => cancelOrder(order.id)}\r\n                                      className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\r\n                                    >\r\n                                      Yes, Cancel\r\n                                    </AlertDialogAction>\r\n                                  </AlertDialogFooter>\r\n                                </AlertDialogContent>\r\n                              </AlertDialog>\r\n                            </>\r\n                          )}\r\n                          {order.status === 'preparing' && (\r\n                            <>\r\n                              <Button size=\"sm\" onClick={() => updateOrderStatus(order.id, 'ready_for_pickup')}>\r\n                                Ready for Pickup\r\n                              </Button>\r\n                              <AlertDialog>\r\n                                <AlertDialogTrigger asChild>\r\n                                  <Button size=\"sm\" variant=\"outline\" className=\"text-destructive\">\r\n                                    <XCircle className=\"w-3 h-3 mr-1\" />\r\n                                    Cancel\r\n                                  </Button>\r\n                                </AlertDialogTrigger>\r\n                                <AlertDialogContent>\r\n                                  <AlertDialogHeader>\r\n                                    <AlertDialogTitle>Cancel Order?</AlertDialogTitle>\r\n                                    <AlertDialogDescription>\r\n                                      This order is being prepared. Are you sure you want to cancel it?\r\n                                    </AlertDialogDescription>\r\n                                  </AlertDialogHeader>\r\n                                  <AlertDialogFooter>\r\n                                    <AlertDialogCancel>Keep Order</AlertDialogCancel>\r\n                                    <AlertDialogAction\r\n                                      onClick={() => cancelOrder(order.id)}\r\n                                      className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\r\n                                    >\r\n                                      Yes, Cancel\r\n                                    </AlertDialogAction>\r\n                                  </AlertDialogFooter>\r\n                                </AlertDialogContent>\r\n                              </AlertDialog>\r\n                            </>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n\r\n                      {/* Show Pickup OTP when ready for pickup */}\r\n                      {order.status === 'ready_for_pickup' && order.pickup_otp && (\r\n                        <div className=\"mt-3 p-3 bg-accent/10 rounded-lg border border-accent/20\">\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <Key className=\"w-4 h-4 text-accent\" />\r\n                            <span className=\"text-sm font-medium text-accent\">Pickup OTP:</span>\r\n                            <span className=\"font-mono font-bold text-lg text-accent tracking-widest\">{order.pickup_otp}</span>\r\n                          </div>\r\n                          <span className=\"text-sm text-muted-foreground\">Share this code with the delivery partner for order handoff</span>\r\n                        </div>\r\n                      )}\r\n\r\n                      {/* Payment method badge */}\r\n                      <div className=\"flex items-center gap-2 mt-2\">\r\n                        {order.payment_method === 'cod' ? (\r\n                          <span className=\"flex items-center gap-1 text-xs bg-accent/10 text-accent px-2 py-1 rounded-full\">\r\n                            <Banknote className=\"w-3 h-3\" /> Cash on Delivery\r\n                          </span>\r\n                        ) : (\r\n                          <span className=\"flex items-center gap-1 text-xs bg-primary/10 text-primary px-2 py-1 rounded-full\">\r\n                            <Smartphone className=\"w-3 h-3\" /> Google Pay\r\n                          </span>\r\n                        )}\r\n                      </div>\r\n                    </CardContent>\r\n                  </Card>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </TabsContent>\r\n\r\n          {/* Menu Tab */}\r\n          <TabsContent value=\"menu\" className=\"space-y-4\">\r\n            <div className=\"flex justify-between items-center\">\r\n              <h2 className=\"text-lg font-semibold\">Menu Items</h2>\r\n              <Dialog open={showAddItem} onOpenChange={setShowAddItem}>\r\n                <DialogTrigger asChild>\r\n                  <Button size=\"sm\">\r\n                    <Plus className=\"w-4 h-4 mr-2\" />\r\n                    Add Item\r\n                  </Button>\r\n                </DialogTrigger>\r\n                <DialogContent>\r\n                  <DialogHeader>\r\n                    <DialogTitle>Add Menu Item</DialogTitle>\r\n                  </DialogHeader>\r\n                  <div className=\"space-y-4\">\r\n                    <div className=\"space-y-2\">\r\n                      <Label>Name *</Label>\r\n                      <Input\r\n                        value={menuItemForm.name}\r\n                        onChange={(e) => setMenuItemForm({ ...menuItemForm, name: e.target.value })}\r\n                      />\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label>Description</Label>\r\n                      <Textarea\r\n                        value={menuItemForm.description}\r\n                        onChange={(e) => setMenuItemForm({ ...menuItemForm, description: e.target.value })}\r\n                      />\r\n                    </div>\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                      <div className=\"space-y-2\">\r\n                        <Label>Price () *</Label>\r\n                        <Input\r\n                          type=\"number\"\r\n                          step=\"0.01\"\r\n                          value={menuItemForm.price}\r\n                          onChange={(e) => setMenuItemForm({ ...menuItemForm, price: e.target.value })}\r\n                        />\r\n                      </div>\r\n                      <div className=\"space-y-2\">\r\n                        <Label>Category</Label>\r\n                        <Input\r\n                          value={menuItemForm.category}\r\n                          onChange={(e) => setMenuItemForm({ ...menuItemForm, category: e.target.value })}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    <MenuImageUpload\r\n                      currentImageUrl={menuItemForm.image_url}\r\n                      onImageChange={(url) => setMenuItemForm({ ...menuItemForm, image_url: url })}\r\n                      restaurantId={restaurant?.id || ''}\r\n                    />\r\n                    <Button className=\"w-full\" onClick={addMenuItem}>Add Item</Button>\r\n                  </div>\r\n                </DialogContent>\r\n              </Dialog>\r\n            </div>\r\n\r\n            {/* Search Menu */}\r\n            <div className=\"relative\">\r\n              <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground\" />\r\n              <Input\r\n                placeholder=\"Search menu items...\"\r\n                value={searchMenu}\r\n                onChange={(e) => setSearchMenu(e.target.value)}\r\n                className=\"pl-9\"\r\n              />\r\n            </div>\r\n\r\n            {filteredMenuItems.length === 0 ? (\r\n              <Card className=\"border-0 shadow-sm\">\r\n                <CardContent className=\"py-16 text-center\">\r\n                  <p className=\"text-muted-foreground\">\r\n                    {searchMenu ? 'No items found' : 'No menu items yet. Add your first item!'}\r\n                  </p>\r\n                </CardContent>\r\n              </Card>\r\n            ) : (\r\n              <div className=\"grid gap-4\">\r\n                {filteredMenuItems.map((item) => (\r\n                  <Card key={item.id} className=\"border-0 shadow-sm\">\r\n                    <CardContent className=\"p-4\">\r\n                      <div className=\"flex items-center gap-4\">\r\n                        {item.image_url && (\r\n                          <img src={item.image_url} alt={item.name} className=\"w-16 h-16 object-cover rounded-lg\" />\r\n                        )}\r\n                        <div className=\"flex-1\">\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <h3 className=\"font-semibold\">{item.name}</h3>\r\n                            {!item.is_available && (\r\n                              <span className=\"text-xs bg-muted text-muted-foreground px-2 py-0.5 rounded\">Unavailable</span>\r\n                            )}\r\n                          </div>\r\n                          {item.category && <p className=\"text-sm text-muted-foreground\">{item.category}</p>}\r\n                          <p className=\"text-primary font-bold\">{Number(item.price).toFixed(2)}</p>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <Switch\r\n                            checked={item.is_available}\r\n                            onCheckedChange={() => toggleItemAvailability(item)}\r\n                          />\r\n                          <Button\r\n                            size=\"icon\"\r\n                            variant=\"ghost\"\r\n                            onClick={() => {\r\n                              setEditingItem(item);\r\n                              setMenuItemForm({\r\n                                name: item.name,\r\n                                description: item.description || '',\r\n                                price: item.price.toString(),\r\n                                category: item.category || '',\r\n                                image_url: item.image_url || '',\r\n                              });\r\n                            }}\r\n                          >\r\n                            <Edit className=\"w-4 h-4\" />\r\n                          </Button>\r\n                          <Button\r\n                            size=\"icon\"\r\n                            variant=\"ghost\"\r\n                            className=\"text-destructive hover:text-destructive\"\r\n                            onClick={() => deleteMenuItem(item.id)}\r\n                          >\r\n                            <Trash2 className=\"w-4 h-4\" />\r\n                          </Button>\r\n                        </div>\r\n                      </div>\r\n                    </CardContent>\r\n                  </Card>\r\n                ))}\r\n              </div>\r\n            )}\r\n\r\n            {/* Edit Dialog */}\r\n            <Dialog open={!!editingItem} onOpenChange={(open) => !open && setEditingItem(null)}>\r\n              <DialogContent>\r\n                <DialogHeader>\r\n                  <DialogTitle>Edit Menu Item</DialogTitle>\r\n                </DialogHeader>\r\n                <div className=\"space-y-4\">\r\n                  <div className=\"space-y-2\">\r\n                    <Label>Name *</Label>\r\n                    <Input\r\n                      value={menuItemForm.name}\r\n                      onChange={(e) => setMenuItemForm({ ...menuItemForm, name: e.target.value })}\r\n                    />\r\n                  </div>\r\n                  <div className=\"space-y-2\">\r\n                    <Label>Description</Label>\r\n                    <Textarea\r\n                      value={menuItemForm.description}\r\n                      onChange={(e) => setMenuItemForm({ ...menuItemForm, description: e.target.value })}\r\n                    />\r\n                  </div>\r\n                  <div className=\"grid grid-cols-2 gap-4\">\r\n                    <div className=\"space-y-2\">\r\n                      <Label>Price () *</Label>\r\n                      <Input\r\n                        type=\"number\"\r\n                        step=\"0.01\"\r\n                        value={menuItemForm.price}\r\n                        onChange={(e) => setMenuItemForm({ ...menuItemForm, price: e.target.value })}\r\n                      />\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label>Category</Label>\r\n                      <Input\r\n                        value={menuItemForm.category}\r\n                        onChange={(e) => setMenuItemForm({ ...menuItemForm, category: e.target.value })}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                  <MenuImageUpload\r\n                    currentImageUrl={menuItemForm.image_url}\r\n                    onImageChange={(url) => setMenuItemForm({ ...menuItemForm, image_url: url })}\r\n                    restaurantId={restaurant?.id || ''}\r\n                  />\r\n                  <Button className=\"w-full\" onClick={updateMenuItem}>Save Changes</Button>\r\n                </div>\r\n              </DialogContent>\r\n            </Dialog>\r\n          </TabsContent>\r\n\r\n          {/* History Tab */}\r\n          <TabsContent value=\"history\" className=\"space-y-4\">\r\n            <h2 className=\"text-lg font-semibold flex items-center gap-2\">\r\n              <History className=\"w-5 h-5\" />\r\n              Order History\r\n            </h2>\r\n            {orderHistory.length === 0 ? (\r\n              <Card className=\"border-0 shadow-sm\">\r\n                <CardContent className=\"py-16 text-center\">\r\n                  <History className=\"w-16 h-16 text-muted-foreground/30 mx-auto mb-4\" />\r\n                  <h3 className=\"text-xl font-semibold mb-2\">No order history</h3>\r\n                  <p className=\"text-muted-foreground\">Completed orders will appear here</p>\r\n                </CardContent>\r\n              </Card>\r\n            ) : (\r\n              <div className=\"grid gap-3\">\r\n                {orderHistory.map((order) => (\r\n                  <Card key={order.id} className=\"border-0 shadow-sm\">\r\n                    <CardContent className=\"p-4\">\r\n                      <div className=\"flex items-center justify-between\">\r\n                        <div className=\"flex items-center gap-3\">\r\n                          <span className=\"font-mono text-sm bg-secondary px-1.5 py-0.5 rounded\">\r\n                            {getShortOrderId(order.id)}\r\n                          </span>\r\n                          <StatusBadge status={order.status as OrderStatus} />\r\n                        </div>\r\n                        <p className=\"font-bold text-primary\">{Number(order.total_amount).toFixed(2)}</p>\r\n                      </div>\r\n                      <div className=\"flex items-center justify-between mt-2 text-sm text-muted-foreground\">\r\n                        <span>{order.customer_profile?.full_name || 'Customer'}</span>\r\n                        <span>{format(new Date(order.created_at), 'MMM d, h:mm a')}</span>\r\n                      </div>\r\n                    </CardContent>\r\n                  </Card>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </TabsContent>\r\n\r\n          {/* Earnings Tab */}\r\n          <TabsContent value=\"earnings\" className=\"space-y-6\">\r\n            {/* Net Earnings Cards */}\r\n            <div>\r\n              <h3 className=\"text-sm font-medium text-muted-foreground mb-3\">Your Net Earnings</h3>\r\n              <div className=\"grid grid-cols-2 gap-4\">\r\n                <Card className=\"border-0 shadow-sm bg-gradient-to-br from-accent/5 to-accent/10\">\r\n                  <CardContent className=\"p-4\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <div className=\"w-10 h-10 rounded-lg bg-accent/20 flex items-center justify-center\">\r\n                        <IndianRupee className=\"w-5 h-5 text-accent\" />\r\n                      </div>\r\n                      <div>\r\n                        <p className=\"text-sm text-muted-foreground\">Today</p>\r\n                        <p className=\"text-2xl font-bold text-accent\">{earnings.today.toFixed(0)}</p>\r\n                      </div>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n                <Card className=\"border-0 shadow-sm bg-gradient-to-br from-primary/5 to-primary/10\">\r\n                  <CardContent className=\"p-4\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <div className=\"w-10 h-10 rounded-lg bg-primary/20 flex items-center justify-center\">\r\n                        <TrendingUp className=\"w-5 h-5 text-primary\" />\r\n                      </div>\r\n                      <div>\r\n                        <p className=\"text-sm text-muted-foreground\">This Week</p>\r\n                        <p className=\"text-2xl font-bold text-primary\">{earnings.week.toFixed(0)}</p>\r\n                      </div>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n                <Card className=\"border-0 shadow-sm bg-gradient-to-br from-status-delivered/5 to-status-delivered/10\">\r\n                  <CardContent className=\"p-4\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <div className=\"w-10 h-10 rounded-lg bg-status-delivered/20 flex items-center justify-center\">\r\n                        <Wallet className=\"w-5 h-5 text-status-delivered\" />\r\n                      </div>\r\n                      <div>\r\n                        <p className=\"text-sm text-muted-foreground\">Total Net Earnings</p>\r\n                        <p className=\"text-2xl font-bold text-status-delivered\">{earnings.total.toFixed(0)}</p>\r\n                      </div>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n                <Card className=\"border-0 shadow-sm\">\r\n                  <CardContent className=\"p-4\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <div className=\"w-10 h-10 rounded-lg bg-secondary flex items-center justify-center\">\r\n                        <Package className=\"w-5 h-5 text-muted-foreground\" />\r\n                      </div>\r\n                      <div>\r\n                        <p className=\"text-sm text-muted-foreground\">Orders Delivered</p>\r\n                        <p className=\"text-2xl font-bold\">{earnings.orderCount}</p>\r\n                      </div>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Settlement Breakdown */}\r\n            <Card className=\"border-0 shadow-sm\">\r\n              <CardHeader>\r\n                <CardTitle className=\"text-base flex items-center gap-2\">\r\n                  <IndianRupee className=\"w-4 h-4\" />\r\n                  Settlement Breakdown\r\n                </CardTitle>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-3\">\r\n                <div className=\"flex items-center justify-between p-3 bg-secondary/50 rounded-lg\">\r\n                  <span className=\"text-sm text-muted-foreground\">Gross Order Value</span>\r\n                  <span className=\"font-bold\">{earnings.grossTotal.toFixed(0)}</span>\r\n                </div>\r\n                <div className=\"flex items-center justify-between p-3 bg-destructive/5 rounded-lg border border-destructive/10\">\r\n                  <span className=\"text-sm text-muted-foreground flex items-center gap-2\">\r\n                    <Bike className=\"w-4 h-4\" />\r\n                    Delivery Fees (Platform)\r\n                  </span>\r\n                  <span className=\"font-medium text-destructive\">- {earnings.deliveryFees.toFixed(0)}</span>\r\n                </div>\r\n                <div className=\"flex items-center justify-between p-3 bg-destructive/5 rounded-lg border border-destructive/10\">\r\n                  <span className=\"text-sm text-muted-foreground flex items-center gap-2\">\r\n                    <IndianRupee className=\"w-4 h-4\" />\r\n                    Platform Fees (8/order)\r\n                  </span>\r\n                  <span className=\"font-medium text-destructive\">- {earnings.platformFees.toFixed(0)}</span>\r\n                </div>\r\n                <div className=\"flex items-center justify-between p-3 bg-destructive/5 rounded-lg border border-destructive/10\">\r\n                  <span className=\"text-sm text-muted-foreground flex items-center gap-2\">\r\n                    <Percent className=\"w-4 h-4\" />\r\n                    Commission ({restaurant?.commission_rate || 15}%)\r\n                  </span>\r\n                  <span className=\"font-medium text-destructive\">- {earnings.commission.toFixed(0)}</span>\r\n                </div>\r\n                <div className=\"flex items-center justify-between p-4 bg-accent/10 rounded-lg border border-accent/20\">\r\n                  <span className=\"text-sm font-semibold text-accent\">Your Net Earnings</span>\r\n                  <span className=\"font-bold text-lg text-accent\">{earnings.total.toFixed(0)}</span>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Commission Info */}\r\n            <Card className=\"border-0 shadow-sm\">\r\n              <CardHeader>\r\n                <CardTitle className=\"text-base\">Payment Schedule</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"flex items-center justify-between p-3 bg-secondary/50 rounded-lg\">\r\n                  <span className=\"text-sm text-muted-foreground\">Settlement Frequency</span>\r\n                  <span className=\"font-medium\">Weekly</span>\r\n                </div>\r\n                <p className=\"text-xs text-muted-foreground mt-3\">\r\n                  Earnings are settled every Monday. Delivery fees and platform fees are collected by the platform. Commission is deducted from your order subtotal.\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n          </TabsContent>\r\n\r\n          {/* Settings Tab */}\r\n          <TabsContent value=\"settings\" className=\"space-y-6\">\r\n            <Card className=\"border-0 shadow-sm\">\r\n              <CardHeader>\r\n                <CardTitle className=\"text-base flex items-center gap-2\">\r\n                  <MapPin className=\"w-4 h-4\" />\r\n                  Shop Location\r\n                </CardTitle>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-4\">\r\n                <p className=\"text-sm text-muted-foreground\">\r\n                  Set your shop's GPS location so customers can see distance and get accurate delivery estimates.\r\n                </p>\r\n\r\n                <div className=\"flex items-center justify-between p-3 bg-secondary/50 rounded-lg\">\r\n                  <div>\r\n                    <p className=\"text-sm font-medium\">Current Location</p>\r\n                    {restaurant?.lat && restaurant?.lng ? (\r\n                      <p className=\"text-xs text-accent flex items-center gap-1 mt-1\">\r\n                        <MapPin className=\"w-3 h-3\" />\r\n                        {Number(restaurant.lat).toFixed(4)}, {Number(restaurant.lng).toFixed(4)}\r\n                      </p>\r\n                    ) : (\r\n                      <p className=\"text-xs text-muted-foreground mt-1\">Not set</p>\r\n                    )}\r\n                  </div>\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    onClick={detectCurrentLocation}\r\n                    disabled={detectingLocation}\r\n                    className=\"gap-1\"\r\n                  >\r\n                    {detectingLocation ? (\r\n                      <Loader2 className=\"w-3 h-3 animate-spin\" />\r\n                    ) : (\r\n                      <Navigation className=\"w-3 h-3\" />\r\n                    )}\r\n                    Detect Location\r\n                  </Button>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-2 gap-3\">\r\n                  <div className=\"space-y-1\">\r\n                    <Label className=\"text-xs\">Latitude</Label>\r\n                    <Input\r\n                      type=\"number\"\r\n                      step=\"any\"\r\n                      value={restaurantForm.lat}\r\n                      onChange={(e) => setRestaurantForm({ ...restaurantForm, lat: e.target.value })}\r\n                      placeholder=\"12.9716\"\r\n                    />\r\n                  </div>\r\n                  <div className=\"space-y-1\">\r\n                    <Label className=\"text-xs\">Longitude</Label>\r\n                    <Input\r\n                      type=\"number\"\r\n                      step=\"any\"\r\n                      value={restaurantForm.lng}\r\n                      onChange={(e) => setRestaurantForm({ ...restaurantForm, lng: e.target.value })}\r\n                      placeholder=\"77.5946\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                <Button\r\n                  onClick={updateShopLocation}\r\n                  disabled={!restaurantForm.lat || !restaurantForm.lng}\r\n                  className=\"w-full\"\r\n                >\r\n                  Save Location\r\n                </Button>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            <Card className=\"border-0 shadow-sm\">\r\n              <CardHeader>\r\n                <CardTitle className=\"text-base flex items-center gap-2\">\r\n                  <Store className=\"w-4 h-4\" />\r\n                  Shop Details\r\n                </CardTitle>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-3\">\r\n                <div className=\"flex items-center justify-between p-3 bg-secondary/50 rounded-lg\">\r\n                  <span className=\"text-sm text-muted-foreground\">Shop Name</span>\r\n                  <span className=\"font-medium\">{restaurant?.name}</span>\r\n                </div>\r\n                <div className=\"flex items-center justify-between p-3 bg-secondary/50 rounded-lg\">\r\n                  <span className=\"text-sm text-muted-foreground\">Address</span>\r\n                  <span className=\"font-medium text-sm text-right max-w-[200px] truncate\">{restaurant?.address}</span>\r\n                </div>\r\n                <div className=\"flex items-center justify-between p-3 bg-secondary/50 rounded-lg\">\r\n                  <span className=\"text-sm text-muted-foreground\">Verification Status</span>\r\n                  <span className={`font-medium ${restaurant?.is_verified ? 'text-accent' : 'text-status-pending'}`}>\r\n                    {restaurant?.is_verified ? 'Verified' : 'Pending'}\r\n                  </span>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </TabsContent>\r\n        </Tabs>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\stores\\cartStore.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\types\\database.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\src\\vite-env.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\tailwind.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\test-supabase.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\foodiempt-main\\vite.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]